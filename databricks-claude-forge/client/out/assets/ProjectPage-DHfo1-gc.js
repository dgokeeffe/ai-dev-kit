const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/vendor-codemirror-langs-BImiyzWt.js","assets/vendor-codemirror-core-V-XIfwkE.js"])))=>i.map(i=>d[i]);
var zt=e=>{throw TypeError(e)};var Pt=(e,r,a)=>r.has(e)||zt("Cannot "+a);var _e=(e,r,a)=>(Pt(e,r,"read from private field"),a?a.call(e):r.get(e)),Rt=(e,r,a)=>r.has(e)?zt("Cannot add the same private member more than once"):r instanceof WeakSet?r.add(e):r.set(e,a),Mt=(e,r,a,s)=>(Pt(e,r,"write to private field"),s?s.call(e,a):r.set(e,a),a);import{j as t,M as Hr,r as Vr,_ as ve}from"./vendor-markdown-BgprssiS.js";import{c as o,f as Wr,u as qr}from"./vendor-react-BKZEzP7s.js";import{c as W,f as Lt,b as Ur,r as Kr,d as Tt,R as Le,s as Jr,t as ne,g as Ue,e as Xr,h as Yr,u as Qr,i as Zr,j as ea,k as ta,l as Be,m as ra,n as aa,o as sa,p as na}from"./index-Dskg7ola.js";import{c as L,G as ar,a as oa,L as ye,X as Ae,F as sr,b as Oe,g as Ie,d as la,T as ia,B as ca,M as Dt,e as da}from"./templates-DBGChb8q.js";import{S as nt,C as ua,a as Je}from"./sparkles-C8RIpJ0e.js";import{r as fa,a as ma,b as ha}from"./vendor-xterm-BCk906R6.js";import{K as xa,M as pa,O as va,Q as ga,R as ya,S as ba,U as wa,V as ja,W as ka,X as Sa,Y as Na,Z as Ca,y as Ea,E as rt,F as _t,_ as za,$ as Pa,a0 as Ra,a1 as Ma,a2 as La,a3 as Ta,a4 as Da}from"./vendor-codemirror-core-V-XIfwkE.js";/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _a=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],$a=W("arrow-down",_a);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fa=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],Aa=W("arrow-up",Fa);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oa=[["path",{d:"m2 16 4.039-9.69a.5.5 0 0 1 .923 0L11 16",key:"d5nyq2"}],["path",{d:"M22 9v7",key:"pvm9v3"}],["path",{d:"M3.304 13h6.392",key:"1q3zxz"}],["circle",{cx:"18.5",cy:"12.5",r:"3.5",key:"z97x68"}]],Ia=W("case-sensitive",Oa);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ga=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],$t=W("check",Ga);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ba=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Ge=W("chevron-down",Ba);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ha=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Ft=W("circle-alert",Ha);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Va=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Wa=W("circle-x",Va);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qa=[["path",{d:"M15 6v12a3 3 0 1 0 3-3H6a3 3 0 1 0 3 3V6a3 3 0 1 0-3 3h12a3 3 0 1 0-3-3",key:"11bfej"}]],Ua=W("command",qa);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ka=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],nr=W("external-link",Ka);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ja=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Xa=W("eye",Ja);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ya=[["path",{d:"M10 12.5 8 15l2 2.5",key:"1tg20x"}],["path",{d:"m14 12.5 2 2.5-2 2.5",key:"yinavb"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7z",key:"1mlx9k"}]],Re=W("file-code",Ya);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qa=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]],or=W("file-json",Qa);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Za=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],je=W("file-text",Za);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const es=[["path",{d:"M15 2a2 2 0 0 1 1.414.586l4 4A2 2 0 0 1 21 8v7a2 2 0 0 1-2 2h-8a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2z",key:"1vo8kb"}],["path",{d:"M15 2v4a2 2 0 0 0 2 2h4",key:"sud9ri"}],["path",{d:"M5 7a2 2 0 0 0-2 2v11a2 2 0 0 0 2 2h8a2 2 0 0 0 1.732-1",key:"l4dndm"}]],ts=W("files",es);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rs=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],lr=W("folder-open",rs);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const as=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],ss=W("funnel",as);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ns=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],At=W("globe",ns);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const os=[["circle",{cx:"12",cy:"9",r:"1",key:"124mty"}],["circle",{cx:"19",cy:"9",r:"1",key:"1ruzo2"}],["circle",{cx:"5",cy:"9",r:"1",key:"1a8b28"}],["circle",{cx:"12",cy:"15",r:"1",key:"1e56xg"}],["circle",{cx:"19",cy:"15",r:"1",key:"1a92ep"}],["circle",{cx:"5",cy:"15",r:"1",key:"5r1jwy"}]],ir=W("grip-horizontal",os);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ls=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],cr=W("grip-vertical",ls);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const is=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],cs=W("history",is);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ds=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],us=W("maximize-2",ds);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fs=[["path",{d:"m14 10 7-7",key:"oa77jy"}],["path",{d:"M20 10h-6V4",key:"mjg0md"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M4 14h6v6",key:"rmj7iw"}]],ms=W("minimize-2",fs);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hs=[["path",{d:"M5 12h14",key:"1ays0h"}]],xs=W("minus",hs);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ps=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],dr=W("play",ps);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vs=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],ot=W("plus",vs);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gs=[["path",{d:"M17 3v10",key:"15fgeh"}],["path",{d:"m12.67 5.5 8.66 5",key:"1gpheq"}],["path",{d:"m12.67 10.5 8.66-5",key:"1dkfa6"}],["path",{d:"M9 17a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h2a2 2 0 0 0 2-2v-2z",key:"swwfx4"}]],ys=W("regex",gs);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bs=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],ft=W("search",bs);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ws=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],js=W("settings",ws);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ks=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],Ss=W("square",ks);function Ns(e,r){const a=getComputedStyle(e),s=parseFloat(a.fontSize);return r*s}function Cs(e,r){const a=getComputedStyle(e.ownerDocument.body),s=parseFloat(a.fontSize);return r*s}function Es(e){return e/100*window.innerHeight}function zs(e){return e/100*window.innerWidth}function Ps(e){switch(typeof e){case"number":return[e,"px"];case"string":{const r=parseFloat(e);return e.endsWith("%")?[r,"%"]:e.endsWith("px")?[r,"px"]:e.endsWith("rem")?[r,"rem"]:e.endsWith("em")?[r,"em"]:e.endsWith("vh")?[r,"vh"]:e.endsWith("vw")?[r,"vw"]:[r,"%"]}}}function He({groupSize:e,panelElement:r,styleProp:a}){let s;const[n,i]=Ps(a);switch(i){case"%":{s=n/100*e;break}case"px":{s=n;break}case"rem":{s=Cs(r,n);break}case"em":{s=Ns(r,n);break}case"vh":{s=Es(n);break}case"vw":{s=zs(n);break}}return s}function de(e){return parseFloat(e.toFixed(3))}function Me({group:e}){const{orientation:r,panels:a}=e;return a.reduce((s,n)=>(s+=r==="horizontal"?n.element.offsetWidth:n.element.offsetHeight,s),0)}function lt(e){const{panels:r}=e,a=Me({group:e});return a===0?r.map(s=>({collapsedSize:0,collapsible:s.panelConstraints.collapsible===!0,defaultSize:void 0,disabled:s.panelConstraints.disabled,minSize:0,maxSize:100,panelId:s.id})):r.map(s=>{const{element:n,panelConstraints:i}=s;let f=0;if(i.collapsedSize!==void 0){const d=He({groupSize:a,panelElement:n,styleProp:i.collapsedSize});f=de(d/a*100)}let l;if(i.defaultSize!==void 0){const d=He({groupSize:a,panelElement:n,styleProp:i.defaultSize});l=de(d/a*100)}let c=0;if(i.minSize!==void 0){const d=He({groupSize:a,panelElement:n,styleProp:i.minSize});c=de(d/a*100)}let u=100;if(i.maxSize!==void 0){const d=He({groupSize:a,panelElement:n,styleProp:i.maxSize});u=de(d/a*100)}return{collapsedSize:f,collapsible:i.collapsible===!0,defaultSize:l,disabled:i.disabled,minSize:c,maxSize:u,panelId:s.id}})}function V(e,r="Assertion error"){if(!e)throw Error(r)}function it(e,r){return Array.from(r).sort(e==="horizontal"?Rs:Ms)}function Rs(e,r){const a=e.element.offsetLeft-r.element.offsetLeft;return a!==0?a:e.element.offsetWidth-r.element.offsetWidth}function Ms(e,r){const a=e.element.offsetTop-r.element.offsetTop;return a!==0?a:e.element.offsetHeight-r.element.offsetHeight}function ur(e){return e!==null&&typeof e=="object"&&"nodeType"in e&&e.nodeType===Node.ELEMENT_NODE}function fr(e,r){return{x:e.x>=r.left&&e.x<=r.right?0:Math.min(Math.abs(e.x-r.left),Math.abs(e.x-r.right)),y:e.y>=r.top&&e.y<=r.bottom?0:Math.min(Math.abs(e.y-r.top),Math.abs(e.y-r.bottom))}}function Ls({orientation:e,rects:r,targetRect:a}){const s={x:a.x+a.width/2,y:a.y+a.height/2};let n,i=Number.MAX_VALUE;for(const f of r){const{x:l,y:c}=fr(s,f),u=e==="horizontal"?l:c;u<i&&(i=u,n=f)}return V(n,"No rect found"),n}let Ve;function Ts(){return Ve===void 0&&(typeof matchMedia=="function"?Ve=!!matchMedia("(pointer:coarse)").matches:Ve=!1),Ve}function mr(e){const{element:r,orientation:a,panels:s,separators:n}=e,i=it(a,Array.from(r.children).filter(ur).map(m=>({element:m}))).map(({element:m})=>m),f=[];let l=!1,c=!1,u=-1,d=-1,v=0,h,p=[];{let m=-1;for(const x of i)x.hasAttribute("data-panel")&&(m++,x.ariaDisabled===null&&(v++,u===-1&&(u=m),d=m))}if(v>1){let m=-1;for(const x of i)if(x.hasAttribute("data-panel")){m++;const y=s.find(g=>g.element===x);if(y){if(h){const g=h.element.getBoundingClientRect(),N=x.getBoundingClientRect();let j;if(c){const b=a==="horizontal"?new DOMRect(g.right,g.top,0,g.height):new DOMRect(g.left,g.bottom,g.width,0),w=a==="horizontal"?new DOMRect(N.left,N.top,0,N.height):new DOMRect(N.left,N.top,N.width,0);switch(p.length){case 0:{j=[b,w];break}case 1:{const P=p[0],R=Ls({orientation:a,rects:[g,N],targetRect:P.element.getBoundingClientRect()});j=[P,R===g?w:b];break}default:{j=p;break}}}else p.length?j=p:j=[a==="horizontal"?new DOMRect(g.right,N.top,N.left-g.right,N.height):new DOMRect(N.left,g.bottom,N.width,N.top-g.bottom)];for(const b of j){let w="width"in b?b:b.element.getBoundingClientRect();const P=Ts()?e.resizeTargetMinimumSize.coarse:e.resizeTargetMinimumSize.fine;if(w.width<P){const z=P-w.width;w=new DOMRect(w.x-z/2,w.y,w.width+z,w.height)}if(w.height<P){const z=P-w.height;w=new DOMRect(w.x,w.y-z/2,w.width,w.height+z)}const R=m<=u||m>d;!l&&!R&&f.push({group:e,groupSize:Me({group:e}),panels:[h,y],separator:"width"in b?void 0:b,rect:w}),l=!1}}c=!1,h=y,p=[]}}else if(x.hasAttribute("data-separator")){x.ariaDisabled!==null&&(l=!0);const y=n.find(g=>g.element===x);y?p.push(y):(h=void 0,p=[])}else c=!0}return f}var ge;class Ds{constructor(){Rt(this,ge,{})}addListener(r,a){const s=_e(this,ge)[r];return s===void 0?_e(this,ge)[r]=[a]:s.includes(a)||s.push(a),()=>{this.removeListener(r,a)}}emit(r,a){const s=_e(this,ge)[r];if(s!==void 0)if(s.length===1)s[0].call(null,a);else{let n=!1,i=null;const f=Array.from(s);for(let l=0;l<f.length;l++){const c=f[l];try{c.call(null,a)}catch(u){i===null&&(n=!0,i=u)}}if(n)throw i}}removeAllListeners(){Mt(this,ge,{})}removeListener(r,a){const s=_e(this,ge)[r];if(s!==void 0){const n=s.indexOf(a);n>=0&&s.splice(n,1)}}}ge=new WeakMap;function ee(e,r,a=0){return Math.abs(de(e)-de(r))<=a}let oe={cursorFlags:0,interactionState:{state:"inactive"},mountedGroups:new Map};const pe=new Ds;function te(){return oe}function re(e){const r=typeof e=="function"?e(oe):e;if(oe===r)return oe;const a=oe;return oe={...oe,...r},r.cursorFlags!==void 0&&pe.emit("cursorFlagsChange",oe.cursorFlags),r.interactionState!==void 0&&pe.emit("interactionStateChange",oe.interactionState),r.mountedGroups!==void 0&&(oe.mountedGroups.forEach((s,n)=>{s.derivedPanelConstraints.forEach(i=>{if(i.collapsible){const{layout:f}=a.mountedGroups.get(n)??{};if(f){const l=ee(i.collapsedSize,s.layout[i.panelId]),c=ee(i.collapsedSize,f[i.panelId]);l&&!c&&(n.inMemoryLastExpandedPanelSizes[i.panelId]=f[i.panelId])}}})}),pe.emit("mountedGroupsChange",oe.mountedGroups)),oe}function _s(e,r,a){let s,n={x:1/0,y:1/0};for(const i of r){const f=fr(a,i.rect);switch(e){case"horizontal":{f.x<=n.x&&(s=i,n=f);break}case"vertical":{f.y<=n.y&&(s=i,n=f);break}}}return s?{distance:n,hitRegion:s}:void 0}function $s(e){return e!==null&&typeof e=="object"&&"nodeType"in e&&e.nodeType===Node.DOCUMENT_FRAGMENT_NODE}function Fs(e,r){if(e===r)throw new Error("Cannot compare node with itself");const a={a:Gt(e),b:Gt(r)};let s;for(;a.a.at(-1)===a.b.at(-1);)s=a.a.pop(),a.b.pop();V(s,"Stacking order can only be calculated for elements with a common ancestor");const n={a:It(Ot(a.a)),b:It(Ot(a.b))};if(n.a===n.b){const i=s.childNodes,f={a:a.a.at(-1),b:a.b.at(-1)};let l=i.length;for(;l--;){const c=i[l];if(c===f.a)return 1;if(c===f.b)return-1}}return Math.sign(n.a-n.b)}const As=/\b(?:position|zIndex|opacity|transform|webkitTransform|mixBlendMode|filter|webkitFilter|isolation)\b/;function Os(e){const r=getComputedStyle(hr(e)??e).display;return r==="flex"||r==="inline-flex"}function Is(e){const r=getComputedStyle(e);return!!(r.position==="fixed"||r.zIndex!=="auto"&&(r.position!=="static"||Os(e))||+r.opacity<1||"transform"in r&&r.transform!=="none"||"webkitTransform"in r&&r.webkitTransform!=="none"||"mixBlendMode"in r&&r.mixBlendMode!=="normal"||"filter"in r&&r.filter!=="none"||"webkitFilter"in r&&r.webkitFilter!=="none"||"isolation"in r&&r.isolation==="isolate"||As.test(r.willChange)||r.webkitOverflowScrolling==="touch")}function Ot(e){let r=e.length;for(;r--;){const a=e[r];if(V(a,"Missing node"),Is(a))return a}return null}function It(e){return e&&Number(getComputedStyle(e).zIndex)||0}function Gt(e){const r=[];for(;e;)r.push(e),e=hr(e);return r}function hr(e){const{parentNode:r}=e;return $s(r)?r.host:r}function Gs(e,r){return e.x<r.x+r.width&&e.x+e.width>r.x&&e.y<r.y+r.height&&e.y+e.height>r.y}function Bs({groupElement:e,hitRegion:r,pointerEventTarget:a}){if(!ur(a)||a.contains(e)||e.contains(a))return!0;if(Fs(a,e)>0){let s=a;for(;s;){if(s.contains(e))return!0;if(Gs(s.getBoundingClientRect(),r))return!1;s=s.parentElement}}return!0}function mt(e,r){const a=[];return r.forEach((s,n)=>{if(n.disabled)return;const i=mr(n),f=_s(n.orientation,i,{x:e.clientX,y:e.clientY});f&&f.distance.x<=0&&f.distance.y<=0&&Bs({groupElement:n.element,hitRegion:f.hitRegion.rect,pointerEventTarget:e.target})&&a.push(f.hitRegion)}),a}function Hs(e,r){if(e.length!==r.length)return!1;for(let a=0;a<e.length;a++)if(e[a]!=r[a])return!1;return!0}function he(e,r){return ee(e,r)?0:e>r?1:-1}function Pe({overrideDisabledPanels:e,panelConstraints:r,prevSize:a,size:s}){const{collapsedSize:n=0,collapsible:i,disabled:f,maxSize:l=100,minSize:c=0}=r;if(f&&!e)return a;if(he(s,c)<0)if(i){const u=(n+c)/2;he(s,u)<0?s=n:s=c}else s=c;return s=Math.min(l,s),s=de(s),s}function Fe({delta:e,initialLayout:r,panelConstraints:a,pivotIndices:s,prevLayout:n,trigger:i}){if(ee(e,0))return r;const f=i==="imperative-api",l=Object.values(r),c=Object.values(n),u=[...l],[d,v]=s;V(d!=null,"Invalid first pivot index"),V(v!=null,"Invalid second pivot index");let h=0;switch(i){case"keyboard":{{const x=e<0?v:d,y=a[x];V(y,`Panel constraints not found for index ${x}`);const{collapsedSize:g=0,collapsible:N,minSize:j=0}=y;if(N){const b=l[x];if(V(b!=null,`Previous layout not found for panel index ${x}`),ee(b,g)){const w=j-b;he(w,Math.abs(e))>0&&(e=e<0?0-w:w)}}}{const x=e<0?d:v,y=a[x];V(y,`No panel constraints found for index ${x}`);const{collapsedSize:g=0,collapsible:N,minSize:j=0}=y;if(N){const b=l[x];if(V(b!=null,`Previous layout not found for panel index ${x}`),ee(b,j)){const w=b-g;he(w,Math.abs(e))>0&&(e=e<0?0-w:w)}}}break}default:{const x=e<0?v:d,y=a[x];V(y,`Panel constraints not found for index ${x}`);const g=l[x],{collapsible:N,collapsedSize:j,minSize:b}=y;if(N&&he(g,b)<0)if(e>0){const w=b-j,P=w/2,R=g+e;he(R,b)<0&&(e=he(e,P)<=0?0:w)}else{const w=b-j,P=100-w/2,R=g-e;he(R,b)<0&&(e=he(100+e,P)>0?0:-w)}break}}{const x=e<0?1:-1;let y=e<0?v:d,g=0;for(;;){const j=l[y];V(j!=null,`Previous layout not found for panel index ${y}`);const b=Pe({overrideDisabledPanels:f,panelConstraints:a[y],prevSize:j,size:100})-j;if(g+=b,y+=x,y<0||y>=a.length)break}const N=Math.min(Math.abs(e),Math.abs(g));e=e<0?0-N:N}{let x=e<0?d:v;for(;x>=0&&x<a.length;){const y=Math.abs(e)-Math.abs(h),g=l[x];V(g!=null,`Previous layout not found for panel index ${x}`);const N=g-y,j=Pe({overrideDisabledPanels:f,panelConstraints:a[x],prevSize:g,size:N});if(!ee(g,j)&&(h+=g-j,u[x]=j,h.toFixed(3).localeCompare(Math.abs(e).toFixed(3),void 0,{numeric:!0})>=0))break;e<0?x--:x++}}if(Hs(c,u))return n;{const x=e<0?v:d,y=l[x];V(y!=null,`Previous layout not found for panel index ${x}`);const g=y+h,N=Pe({overrideDisabledPanels:f,panelConstraints:a[x],prevSize:y,size:g});if(u[x]=N,!ee(N,g)){let j=g-N,b=e<0?v:d;for(;b>=0&&b<a.length;){const w=u[b];V(w!=null,`Previous layout not found for panel index ${b}`);const P=w+j,R=Pe({overrideDisabledPanels:f,panelConstraints:a[b],prevSize:w,size:P});if(ee(w,R)||(j-=R-w,u[b]=R),ee(j,0))break;e>0?b--:b++}}}const p=Object.values(u).reduce((x,y)=>y+x,0);if(!ee(p,100,.1))return n;const m=Object.keys(n);return u.reduce((x,y,g)=>(x[m[g]]=y,x),{})}function ke(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const a in e)if(r[a]===void 0||he(e[a],r[a])!==0)return!1;return!0}function Se({layout:e,panelConstraints:r}){const a=Object.values(e),s=[...a],n=s.reduce((l,c)=>l+c,0);if(s.length!==r.length)throw Error(`Invalid ${r.length} panel layout: ${s.map(l=>`${l}%`).join(", ")}`);if(!ee(n,100)&&s.length>0)for(let l=0;l<r.length;l++){const c=s[l];V(c!=null,`No layout data found for index ${l}`);const u=100/n*c;s[l]=u}let i=0;for(let l=0;l<r.length;l++){const c=a[l];V(c!=null,`No layout data found for index ${l}`);const u=s[l];V(u!=null,`No layout data found for index ${l}`);const d=Pe({overrideDisabledPanels:!0,panelConstraints:r[l],prevSize:c,size:u});u!=d&&(i+=u-d,s[l]=d)}if(!ee(i,0))for(let l=0;l<r.length;l++){const c=s[l];V(c!=null,`No layout data found for index ${l}`);const u=c+i,d=Pe({overrideDisabledPanels:!0,panelConstraints:r[l],prevSize:c,size:u});if(c!==d&&(i-=d-c,s[l]=d,ee(i,0)))break}const f=Object.keys(e);return s.reduce((l,c,u)=>(l[f[u]]=c,l),{})}function xr({groupId:e,panelId:r}){const a=()=>{const{mountedGroups:l}=te();for(const[c,{defaultLayoutDeferred:u,derivedPanelConstraints:d,layout:v,separatorToPanels:h}]of l)if(c.id===e)return{defaultLayoutDeferred:u,derivedPanelConstraints:d,group:c,layout:v,separatorToPanels:h};throw Error(`Group ${e} not found`)},s=()=>{const l=a().derivedPanelConstraints.find(c=>c.panelId===r);if(l!==void 0)return l;throw Error(`Panel constraints not found for Panel ${r}`)},n=()=>{const l=a().group.panels.find(c=>c.id===r);if(l!==void 0)return l;throw Error(`Layout not found for Panel ${r}`)},i=()=>{const l=a().layout[r];if(l!==void 0)return l;throw Error(`Layout not found for Panel ${r}`)},f=l=>{const c=i();if(l===c)return;const{defaultLayoutDeferred:u,derivedPanelConstraints:d,group:v,layout:h,separatorToPanels:p}=a(),m=v.panels.findIndex(N=>N.id===r),x=m===v.panels.length-1,y=Fe({delta:x?c-l:l-c,initialLayout:h,panelConstraints:d,pivotIndices:x?[m-1,m]:[m,m+1],prevLayout:h,trigger:"imperative-api"}),g=Se({layout:y,panelConstraints:d});ke(h,g)||re(N=>({mountedGroups:new Map(N.mountedGroups).set(v,{defaultLayoutDeferred:u,derivedPanelConstraints:d,layout:g,separatorToPanels:p})}))};return{collapse:()=>{const{collapsible:l,collapsedSize:c}=s(),{mutableValues:u}=n(),d=i();l&&d!==c&&(u.expandToSize=d,f(c))},expand:()=>{const{collapsible:l,collapsedSize:c,minSize:u}=s(),{mutableValues:d}=n(),v=i();if(l&&v===c){let h=d.expandToSize??u;h===0&&(h=1),f(h)}},getSize:()=>{const{group:l}=a(),c=i(),{element:u}=n(),d=l.orientation==="horizontal"?u.offsetWidth:u.offsetHeight;return{asPercentage:c,inPixels:d}},isCollapsed:()=>{const{collapsible:l,collapsedSize:c}=s(),u=i();return l&&ee(c,u)},resize:l=>{if(i()!==l){let c;switch(typeof l){case"number":{const{group:u}=a(),d=Me({group:u});c=de(l/d*100);break}case"string":{c=parseFloat(l);break}}f(c)}}}}function Bt(e){if(e.defaultPrevented)return;const{mountedGroups:r}=te();mt(e,r).forEach(a=>{if(a.separator){const s=a.panels.find(n=>n.panelConstraints.defaultSize!==void 0);if(s){const n=s.panelConstraints.defaultSize,i=xr({groupId:a.group.id,panelId:s.id});i&&n!==void 0&&(i.resize(n),e.preventDefault())}}})}function Ke(e){const{mountedGroups:r}=te();for(const[a]of r)if(a.separators.some(s=>s.element===e))return a;throw Error("Could not find parent Group for separator element")}function pr({groupId:e}){const r=()=>{const{mountedGroups:a}=te();for(const[s,n]of a)if(s.id===e)return{group:s,...n};throw Error(`Could not find Group with id "${e}"`)};return{getLayout(){const{defaultLayoutDeferred:a,layout:s}=r();return a?{}:s},setLayout(a){const{defaultLayoutDeferred:s,derivedPanelConstraints:n,group:i,layout:f,separatorToPanels:l}=r(),c=Se({layout:a,panelConstraints:n});if(s)return f;if(!ke(f,c)){re(d=>({mountedGroups:new Map(d.mountedGroups).set(i,{defaultLayoutDeferred:s,derivedPanelConstraints:n,layout:c,separatorToPanels:l})}));const u=i.panels.map(({id:d})=>d).join(",");i.inMemoryLayouts[u]=c}return c}}}function vr(e){const{mountedGroups:r}=te(),a=r.get(e);return V(a,`Mounted Group ${e.id} not found`),a}function be(e,r){const a=Ke(e),s=vr(a),n=a.separators.find(d=>d.element===e);V(n,"Matching separator not found");const i=s.separatorToPanels.get(n);V(i,"Matching panels not found");const f=i.map(d=>a.panels.indexOf(d)),l=pr({groupId:a.id}).getLayout(),c=Fe({delta:r,initialLayout:l,panelConstraints:s.derivedPanelConstraints,pivotIndices:f,prevLayout:l,trigger:"keyboard"}),u=Se({layout:c,panelConstraints:s.derivedPanelConstraints});ke(l,u)||re(d=>({mountedGroups:new Map(d.mountedGroups).set(a,{defaultLayoutDeferred:s.defaultLayoutDeferred,derivedPanelConstraints:s.derivedPanelConstraints,layout:u,separatorToPanels:s.separatorToPanels})}))}function Ht(e){if(e.defaultPrevented)return;const r=e.currentTarget,a=Ke(r);if(!a.disabled)switch(e.key){case"ArrowDown":{e.preventDefault(),a.orientation==="vertical"&&be(r,5);break}case"ArrowLeft":{e.preventDefault(),a.orientation==="horizontal"&&be(r,-5);break}case"ArrowRight":{e.preventDefault(),a.orientation==="horizontal"&&be(r,5);break}case"ArrowUp":{e.preventDefault(),a.orientation==="vertical"&&be(r,-5);break}case"End":{e.preventDefault(),be(r,100);break}case"Enter":{e.preventDefault();const s=Ke(r),{derivedPanelConstraints:n,layout:i,separatorToPanels:f}=vr(s),l=s.separators.find(v=>v.element===r);V(l,"Matching separator not found");const c=f.get(l);V(c,"Matching panels not found");const u=c[0],d=n.find(v=>v.panelId===u.id);if(V(d,"Panel metadata not found"),d.collapsible){const v=i[u.id],h=d.collapsedSize===v?s.inMemoryLastExpandedPanelSizes[u.id]??d.minSize:d.collapsedSize;be(r,h-v)}break}case"F6":{e.preventDefault();const s=Ke(r).separators.map(f=>f.element),n=Array.from(s).findIndex(f=>f===e.currentTarget);V(n!==null,"Index not found");const i=e.shiftKey?n>0?n-1:s.length-1:n+1<s.length?n+1:0;s[i].focus();break}case"Home":{e.preventDefault(),be(r,-100);break}}}function Vt(e){if(e.defaultPrevented||e.pointerType==="mouse"&&e.button>0)return;const{mountedGroups:r}=te(),a=mt(e,r),s=new Map;let n=!1;a.forEach(i=>{i.separator&&(n||(n=!0,i.separator.element.focus()));const f=r.get(i.group);f&&s.set(i.group,f.layout)}),re({interactionState:{hitRegions:a,initialLayoutMap:s,pointerDownAtPoint:{x:e.clientX,y:e.clientY},state:"active"}}),a.length&&e.preventDefault()}const Vs=e=>e,at=()=>{},gr=1,yr=2,br=4,wr=8,Wt=3,qt=12;let We;function Ut(){return We===void 0&&(We=!1,typeof window<"u"&&(window.navigator.userAgent.includes("Chrome")||window.navigator.userAgent.includes("Firefox"))&&(We=!0)),We}function Ws({cursorFlags:e,groups:r,state:a}){let s=0,n=0;switch(a){case"active":case"hover":r.forEach(i=>{if(!i.disableCursor)switch(i.orientation){case"horizontal":{s++;break}case"vertical":{n++;break}}})}if(!(s===0&&n===0)){switch(a){case"active":{if(e&&Ut()){const i=(e&gr)!==0,f=(e&yr)!==0,l=(e&br)!==0,c=(e&wr)!==0;if(i)return l?"se-resize":c?"ne-resize":"e-resize";if(f)return l?"sw-resize":c?"nw-resize":"w-resize";if(l)return"s-resize";if(c)return"n-resize"}break}}return Ut()?s>0&&n>0?"move":s>0?"ew-resize":"ns-resize":s>0&&n>0?"grab":s>0?"col-resize":"row-resize"}}const Kt=new WeakMap;function ht(e){if(e.defaultView===null||e.defaultView===void 0)return;let{prevStyle:r,styleSheet:a}=Kt.get(e)??{};a===void 0&&(a=new e.defaultView.CSSStyleSheet,e.adoptedStyleSheets.push(a));const{cursorFlags:s,interactionState:n}=te();switch(n.state){case"active":case"hover":{const i=Ws({cursorFlags:s,groups:n.hitRegions.map(l=>l.group),state:n.state}),f=`*, *:hover {cursor: ${i} !important; ${n.state==="active"?"touch-action: none;":""} }`;if(r===f)return;r=f,i?a.cssRules.length===0?a.insertRule(f):a.replaceSync(f):a.cssRules.length===1&&a.deleteRule(0);break}case"inactive":{r=void 0,a.cssRules.length===1&&a.deleteRule(0);break}}Kt.set(e,{prevStyle:r,styleSheet:a})}function jr({document:e,event:r,hitRegions:a,initialLayoutMap:s,mountedGroups:n,pointerDownAtPoint:i,prevCursorFlags:f}){let l=0;const c=new Map(n);a.forEach(d=>{const{group:v,groupSize:h}=d,{disableCursor:p,orientation:m,panels:x}=v;let y=0;i?m==="horizontal"?y=(r.clientX-i.x)/h*100:y=(r.clientY-i.y)/h*100:m==="horizontal"?y=r.clientX<0?-100:100:y=r.clientY<0?-100:100;const g=s.get(v),{defaultLayoutDeferred:N,derivedPanelConstraints:j,layout:b,separatorToPanels:w}=n.get(v)??{defaultLayoutDeferred:!1};if(j&&g&&b&&w){const P=Fe({delta:y,initialLayout:g,panelConstraints:j,pivotIndices:d.panels.map(R=>x.indexOf(R)),prevLayout:b,trigger:"mouse-or-touch"});if(ke(P,b)){if(y!==0&&!p)switch(m){case"horizontal":{l|=y<0?gr:yr;break}case"vertical":{l|=y<0?br:wr;break}}}else{c.set(d.group,{defaultLayoutDeferred:N,derivedPanelConstraints:j,layout:P,separatorToPanels:w});const R=d.group.panels.map(({id:z})=>z).join(",");d.group.inMemoryLayouts[R]=P}}});let u=0;r.movementX===0?u|=f&Wt:u|=l&Wt,r.movementY===0?u|=f&qt:u|=l&qt,re({cursorFlags:u,mountedGroups:c}),ht(e)}function Jt(e){const{cursorFlags:r,interactionState:a,mountedGroups:s}=te();switch(a.state){case"active":jr({document:e.currentTarget,event:e,hitRegions:a.hitRegions,initialLayoutMap:a.initialLayoutMap,mountedGroups:s,prevCursorFlags:r})}}function Xt(e){if(e.defaultPrevented)return;const{cursorFlags:r,interactionState:a,mountedGroups:s}=te();switch(a.state){case"active":{if(e.buttons===0){re(n=>n.interactionState.state==="inactive"?n:{cursorFlags:0,interactionState:{state:"inactive"}}),re(n=>({mountedGroups:new Map(n.mountedGroups)}));return}jr({document:e.currentTarget,event:e,hitRegions:a.hitRegions,initialLayoutMap:a.initialLayoutMap,mountedGroups:s,pointerDownAtPoint:a.pointerDownAtPoint,prevCursorFlags:r});break}default:{const n=mt(e,s);n.length===0?a.state!=="inactive"&&re({interactionState:{state:"inactive"}}):re({interactionState:{hitRegions:n,state:"hover"}}),ht(e.currentTarget);break}}}function Yt(e){if(e.relatedTarget instanceof HTMLIFrameElement){const{interactionState:r}=te();switch(r.state){case"hover":re({interactionState:{state:"inactive"}})}}}function Qt(e){if(e.defaultPrevented||e.pointerType==="mouse"&&e.button>0)return;const{interactionState:r}=te();switch(r.state){case"active":re({cursorFlags:0,interactionState:{state:"inactive"}}),r.hitRegions.length>0&&(ht(e.currentTarget),re(a=>({mountedGroups:new Map(a.mountedGroups)})),e.preventDefault())}}function Zt(e){let r=0,a=0;const s={};for(const i of e)if(i.defaultSize!==void 0){r++;const f=de(i.defaultSize);a+=f,s[i.panelId]=f}else s[i.panelId]=void 0;const n=e.length-r;if(n!==0){const i=de((100-a)/n);for(const f of e)f.defaultSize===void 0&&(s[f.panelId]=i)}return s}function qs(e,r,a){if(!a[0])return;const s=e.panels.find(c=>c.element===r);if(!s||!s.onResize)return;const n=Me({group:e}),i=e.orientation==="horizontal"?s.element.offsetWidth:s.element.offsetHeight,f=s.mutableValues.prevSize,l={asPercentage:de(i/n*100),inPixels:i};s.mutableValues.prevSize=l,s.onResize(l,s.id,f)}function Us(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const a in e)if(e[a]!==r[a])return!1;return!0}function Ks(e,r){const a=e.map(n=>n.id),s=Object.keys(r);if(a.length!==s.length)return!1;for(const n of a)if(!s.includes(n))return!1;return!0}const Ee=new Map;function Js(e){let r=!0;V(e.element.ownerDocument.defaultView,"Cannot register an unmounted Group");const a=e.element.ownerDocument.defaultView.ResizeObserver,s=new Set,n=new Set,i=new a(m=>{for(const x of m){const{borderBoxSize:y,target:g}=x;if(g===e.element){if(r){if(Me({group:e})===0)return;re(N=>{const j=N.mountedGroups.get(e);if(j){const b=lt(e),w=j.defaultLayoutDeferred?Zt(b):j.layout,P=Se({layout:w,panelConstraints:b});return!j.defaultLayoutDeferred&&ke(w,P)&&Us(j.derivedPanelConstraints,b)?N:{mountedGroups:new Map(N.mountedGroups).set(e,{defaultLayoutDeferred:!1,derivedPanelConstraints:b,layout:P,separatorToPanels:j.separatorToPanels})}}return N})}}else qs(e,g,y)}});i.observe(e.element),e.panels.forEach(m=>{V(!s.has(m.id),`Panel ids must be unique; id "${m.id}" was used more than once`),s.add(m.id),m.onResize&&i.observe(m.element)});const f=Me({group:e}),l=lt(e),c=e.panels.map(({id:m})=>m).join(",");let u=e.defaultLayout;u&&(Ks(e.panels,u)||(u=void 0));const d=e.inMemoryLayouts[c]??u??Zt(l),v=Se({layout:d,panelConstraints:l}),h=mr(e),p=e.element.ownerDocument;return re(m=>{const x=new Map;return Ee.set(p,(Ee.get(p)??0)+1),h.forEach(y=>{y.separator&&x.set(y.separator,y.panels)}),{mountedGroups:new Map(m.mountedGroups).set(e,{defaultLayoutDeferred:f===0,derivedPanelConstraints:l,layout:v,separatorToPanels:x})}}),e.separators.forEach(m=>{V(!n.has(m.id),`Separator ids must be unique; id "${m.id}" was used more than once`),n.add(m.id),m.element.addEventListener("keydown",Ht)}),Ee.get(p)===1&&(p.addEventListener("dblclick",Bt,!0),p.addEventListener("pointerdown",Vt,!0),p.addEventListener("pointerleave",Jt),p.addEventListener("pointermove",Xt),p.addEventListener("pointerout",Yt),p.addEventListener("pointerup",Qt,!0)),function(){r=!1,Ee.set(p,Math.max(0,(Ee.get(p)??0)-1)),re(m=>{const x=new Map(m.mountedGroups);return x.delete(e),{mountedGroups:x}}),e.separators.forEach(m=>{m.element.removeEventListener("keydown",Ht)}),Ee.get(p)||(p.removeEventListener("dblclick",Bt,!0),p.removeEventListener("pointerdown",Vt,!0),p.removeEventListener("pointerleave",Jt),p.removeEventListener("pointermove",Xt),p.removeEventListener("pointerout",Yt),p.removeEventListener("pointerup",Qt,!0)),i.disconnect()}}function Xs(){const[e,r]=o.useState({}),a=o.useCallback(()=>r({}),[]);return[e,a]}function xt(e){const r=o.useId();return`${e??r}`}const Ne=typeof window<"u"?o.useLayoutEffect:o.useEffect;function $e(e){const r=o.useRef(e);return Ne(()=>{r.current=e},[e]),o.useCallback((...a)=>{var s;return(s=r.current)==null?void 0:s.call(r,...a)},[r])}function pt(...e){return $e(r=>{e.forEach(a=>{if(a)switch(typeof a){case"function":{a(r);break}case"object":{a.current=r;break}}})})}function vt(e){const r=o.useRef({...e});return Ne(()=>{for(const a in e)r.current[a]=e[a]},[e]),r.current}const kr=o.createContext(null);function Ys(e,r){const a=o.useRef({getLayout:()=>({}),setLayout:Vs});o.useImperativeHandle(r,()=>a.current,[]),Ne(()=>{Object.assign(a.current,pr({groupId:e}))})}function ct({children:e,className:r,defaultLayout:a,disableCursor:s,disabled:n,elementRef:i,groupRef:f,id:l,onLayoutChange:c,onLayoutChanged:u,orientation:d="horizontal",resizeTargetMinimumSize:v={coarse:20,fine:10},style:h,...p}){const m=o.useRef({onLayoutChange:{},onLayoutChanged:{}}),x=$e(C=>{ke(m.current.onLayoutChange,C)||(m.current.onLayoutChange=C,c==null||c(C))}),y=$e(C=>{ke(m.current.onLayoutChanged,C)||(m.current.onLayoutChanged=C,u==null||u(C))}),g=xt(l),N=o.useRef(null),[j,b]=Xs(),w=o.useRef({lastExpandedPanelSizes:{},layouts:{},panels:[],resizeTargetMinimumSize:v,separators:[]}),P=pt(N,i);Ys(g,f);const R=$e((C,E)=>{const{interactionState:G,mountedGroups:K}=te();for(const U of K.keys())if(U.id===C){const M=K.get(U);if(M){let D=!1;switch(G.state){case"active":{D=G.hitRegions.some(B=>B.group===U);break}}return{flexGrow:M.layout[E]??1,pointerEvents:D?"none":void 0}}}return{flexGrow:(a==null?void 0:a[E])??1}}),z=vt({defaultLayout:a,disableCursor:s}),I=o.useMemo(()=>({get disableCursor(){return!!z.disableCursor},getPanelStyles:R,id:g,orientation:d,registerPanel:C=>{const E=w.current;return E.panels=it(d,[...E.panels,C]),b(),()=>{E.panels=E.panels.filter(G=>G!==C),b()}},registerSeparator:C=>{const E=w.current;return E.separators=it(d,[...E.separators,C]),b(),()=>{E.separators=E.separators.filter(G=>G!==C),b()}},togglePanelDisabled:(C,E)=>{const G=w.current.panels.find(U=>U.id===C);G&&(G.panelConstraints.disabled=E);const{mountedGroups:K}=te();for(const U of K.keys())if(U.id===g){const M=K.get(U);M&&(M.derivedPanelConstraints=lt(U))}},toggleSeparatorDisabled:(C,E)=>{const G=w.current.separators.find(K=>K.id===C);G&&(G.disabled=E)}}),[R,g,b,d,z]),T=o.useRef(null);return Ne(()=>{const C=N.current;if(C===null)return;const E=w.current;let G;if(z.defaultLayout!==void 0&&Object.keys(z.defaultLayout).length===E.panels.length){G={};for(const $ of E.panels){const H=z.defaultLayout[$.id];H!==void 0&&(G[$.id]=H)}}const K={defaultLayout:G,disableCursor:!!z.disableCursor,disabled:!!n,element:C,id:g,inMemoryLastExpandedPanelSizes:w.current.lastExpandedPanelSizes,inMemoryLayouts:w.current.layouts,orientation:d,panels:E.panels,resizeTargetMinimumSize:E.resizeTargetMinimumSize,separators:E.separators};T.current=K;const U=Js(K),M=te().mountedGroups.get(K);if(M){const{defaultLayoutDeferred:$,derivedPanelConstraints:H,layout:J}=M;!$&&H.length>0&&(x(J),y(J))}const D=pe.addListener("interactionStateChange",$=>{$.state}),B=pe.addListener("mountedGroupsChange",$=>{const H=$.get(K);if(H){const{defaultLayoutDeferred:J,derivedPanelConstraints:X,layout:Y}=H;if(J||X.length===0)return;const{interactionState:le}=te(),ie=le.state!=="active";x(Y),ie&&y(Y)}});return()=>{T.current=null,U(),D(),B()}},[n,g,y,x,d,j,z]),o.useEffect(()=>{const C=T.current;C&&(C.defaultLayout=a,C.disableCursor=!!s)}),t.jsx(kr.Provider,{value:I,children:t.jsx("div",{...p,className:r,"data-group":!0,"data-testid":g,id:g,ref:P,style:{height:"100%",width:"100%",overflow:"hidden",...h,display:"flex",flexDirection:d==="horizontal"?"row":"column",flexWrap:"nowrap"},children:e})})}ct.displayName="Group";function gt(){const e=o.useContext(kr);return V(e,"Group Context not found; did you render a Panel or Separator outside of a Group?"),e}function Qs(e,r){const{id:a}=gt(),s=o.useRef({collapse:at,expand:at,getSize:()=>({asPercentage:0,inPixels:0}),isCollapsed:()=>!1,resize:at});o.useImperativeHandle(r,()=>s.current,[]),Ne(()=>{Object.assign(s.current,xr({groupId:a,panelId:e}))})}function ze({children:e,className:r,collapsedSize:a="0%",collapsible:s=!1,defaultSize:n,disabled:i,elementRef:f,id:l,maxSize:c="100%",minSize:u="0%",onResize:d,panelRef:v,style:h,...p}){const m=!!l,x=xt(l),y=vt({disabled:i}),g=o.useRef(null),N=pt(g,f),{getPanelStyles:j,id:b,registerPanel:w,togglePanelDisabled:P}=gt(),R=d!==null,z=$e((T,C,E)=>{d==null||d(T,l,E)});Ne(()=>{const T=g.current;if(T!==null){const C={element:T,id:x,idIsStable:m,mutableValues:{expandToSize:void 0,prevSize:void 0},onResize:R?z:void 0,panelConstraints:{collapsedSize:a,collapsible:s,defaultSize:n,disabled:y.disabled,maxSize:c,minSize:u}};return w(C)}},[a,s,n,R,x,m,c,u,z,w,y]),o.useEffect(()=>{P(x,!!i)},[i,x,P]),Qs(x,v);const I=o.useSyncExternalStore(T=>(pe.addListener("mountedGroupsChange",T),()=>{pe.removeListener("mountedGroupsChange",T)}),()=>JSON.stringify(j(b,x)),()=>JSON.stringify(j(b,x)));return t.jsx("div",{...p,"aria-disabled":i||void 0,"data-panel":!0,"data-testid":x,id:x,ref:N,style:{...Zs,display:"flex",flexBasis:0,flexShrink:1,overflow:"hidden",...JSON.parse(I)},children:t.jsx("div",{className:r,style:{maxHeight:"100%",maxWidth:"100%",flexGrow:1,...h},children:e})})}ze.displayName="Panel";const Zs={minHeight:0,maxHeight:"100%",height:"auto",minWidth:0,maxWidth:"100%",width:"auto",border:"none",borderWidth:0,padding:0,margin:0};function en(){return o.useRef(null)}function tn({layout:e,panelConstraints:r,panelId:a,panelIndex:s}){let n,i;const f=e[a],l=r.find(c=>c.panelId===a);if(l){const c=l.maxSize,u=l.collapsible?l.collapsedSize:l.minSize,d=[s,s+1];i=Se({layout:Fe({delta:u-f,initialLayout:e,panelConstraints:r,pivotIndices:d,prevLayout:e}),panelConstraints:r})[a],n=Se({layout:Fe({delta:c-f,initialLayout:e,panelConstraints:r,pivotIndices:d,prevLayout:e}),panelConstraints:r})[a]}return{valueControls:a,valueMax:n,valueMin:i,valueNow:f}}function yt({children:e,className:r,disabled:a,elementRef:s,id:n,style:i,...f}){const l=xt(n),c=vt({disabled:a}),[u,d]=o.useState({}),[v,h]=o.useState("inactive"),p=o.useRef(null),m=pt(p,s),{disableCursor:x,id:y,orientation:g,registerSeparator:N,toggleSeparatorDisabled:j}=gt(),b=g==="horizontal"?"vertical":"horizontal";Ne(()=>{const P=p.current;if(P!==null){const R={disabled:c.disabled,element:P,id:l},z=N(R),I=pe.addListener("interactionStateChange",C=>{h(C.state!=="inactive"&&C.hitRegions.some(E=>E.separator===R)?C.state:"inactive")}),T=pe.addListener("mountedGroupsChange",C=>{C.forEach(({derivedPanelConstraints:E,layout:G,separatorToPanels:K},U)=>{if(U.id===y){const M=K.get(R);if(M){const D=M[0],B=U.panels.indexOf(D);d(tn({layout:G,panelConstraints:E,panelId:D.id,panelIndex:B}))}}})});return()=>{I(),T(),z()}}},[y,l,N,c]),o.useEffect(()=>{j(l,!!a)},[a,l,j]);let w;return a&&!x&&(w="not-allowed"),t.jsx("div",{...f,"aria-controls":u.valueControls,"aria-disabled":a||void 0,"aria-orientation":b,"aria-valuemax":u.valueMax,"aria-valuemin":u.valueMin,"aria-valuenow":u.valueNow,children:e,className:r,"data-separator":a?"disabled":v,"data-testid":l,id:l,ref:m,role:"separator",style:{flexBasis:"auto",cursor:w,...i,flexGrow:0,flexShrink:0},tabIndex:a?void 0:0})}yt.displayName="Separator";const rn=[{id:"explorer",icon:ts,label:"Explorer"},{id:"search",icon:ft,label:"Search"},{id:"git",icon:ar,label:"Source Control"},{id:"chat",icon:oa,label:"Chat"}];function an({activeActivity:e,onActivityChange:r,className:a=""}){const s=n=>{r(e===n?null:n)};return t.jsxs("div",{className:L("flex flex-col w-12 bg-[var(--color-bg-secondary)] border-r border-[var(--color-border)]",a),children:[t.jsx("div",{className:"flex flex-col",children:rn.map(n=>{const i=n.icon,f=e===n.id;return t.jsxs("button",{onClick:()=>s(n.id),className:L("relative flex items-center justify-center h-12 w-12 transition-colors",f?"text-[var(--color-text-primary)]":"text-[var(--color-text-muted)] hover:text-[var(--color-text-primary)]"),title:n.label,children:[f&&t.jsx("div",{className:"absolute left-0 top-1/2 -translate-y-1/2 w-0.5 h-6 bg-[var(--color-accent-primary)]"}),t.jsx(i,{className:"h-5 w-5"})]},n.id)})}),t.jsx("div",{className:"flex-1"}),t.jsx("div",{className:"flex flex-col",children:t.jsx("button",{className:"flex items-center justify-center h-12 w-12 text-[var(--color-text-muted)] hover:text-[var(--color-text-primary)] transition-colors",title:"Settings",children:t.jsx(js,{className:"h-5 w-5"})})})]})}function er({className:e}){return t.jsx(yt,{className:L("w-1 bg-[var(--color-border)] hover:bg-[var(--color-accent-primary)]/50 flex items-center justify-center transition-colors",e),children:t.jsx(cr,{className:"h-4 w-4 text-[var(--color-text-muted)]"})})}function sn({className:e}){return t.jsx(yt,{className:L("h-1 bg-[var(--color-border)] hover:bg-[var(--color-accent-primary)]/50 flex items-center justify-center transition-colors",e),children:t.jsx(ir,{className:"h-4 w-4 text-[var(--color-text-muted)]"})})}function nn({isOpen:e,onToggle:r,activeTab:a,onTabChange:s}){const n=[{id:"terminal",label:"Terminal"},{id:"output",label:"Output"},{id:"deploy",label:"Deploy"},{id:"preview",label:"Preview"}];return t.jsxs("div",{className:"flex items-center h-8 px-2 bg-[var(--color-bg-secondary)] border-b border-[var(--color-border)]",children:[t.jsx("div",{className:"flex items-center gap-1",children:n.map(i=>t.jsx("button",{onClick:()=>{s(i.id),e||r()},className:L("px-2 py-1 text-xs font-medium rounded transition-colors",a===i.id&&e?"bg-[var(--color-bg-tertiary)] text-[var(--color-text-heading)]":"text-[var(--color-text-muted)] hover:text-[var(--color-text-primary)]"),children:i.label},i.id))}),t.jsx("div",{className:"flex-1"}),t.jsx("button",{onClick:r,className:"p-1 text-[var(--color-text-muted)] hover:text-[var(--color-text-primary)] transition-colors",children:e?"▼":"▲"})]})}function on({activeActivity:e,onActivityChange:r,leftSidebar:a,leftSidebarWidth:s=200,onLeftSidebarWidthChange:n,children:i,rightSidebar:f,rightSidebarWidth:l=320,onRightSidebarWidthChange:c,isRightSidebarOpen:u=!0,bottomPanel:d,bottomPanelHeight:v=200,onBottomPanelHeightChange:h,isBottomPanelOpen:p=!1,onBottomPanelToggle:m,isClaudeMaximized:x=!1,maximizedContent:y,bottomPanelTab:g="terminal",onBottomPanelTabChange:N,className:j=""}){const b=en(),w=e==="explorer"||e==="search"||e==="git",P=s/1200*100,R=l/1200*100,z=o.useCallback(E=>{n&&n(Math.round(E.inPixels))},[n]),I=o.useCallback(E=>{c&&c(Math.round(E.inPixels))},[c]),T=o.useCallback(E=>{h&&h(Math.round(E.inPixels))},[h]),C=o.useCallback(()=>{m&&m();const E=b.current;E&&(p?E.collapse():E.expand())},[p,m,b]);return t.jsxs("div",{className:L("flex h-full ide-layout-container",j),children:[t.jsx(an,{activeActivity:e,onActivityChange:r}),t.jsxs(ct,{orientation:"horizontal",className:"flex-1",children:[w&&a&&t.jsxs(t.Fragment,{children:[t.jsx(ze,{id:"left-sidebar",defaultSize:P,minSize:10,maxSize:30,onResize:z,className:"overflow-hidden",children:t.jsx("div",{className:"h-full border-r border-[var(--color-border)]",children:a})}),t.jsx(er,{})]}),t.jsx(ze,{id:"main-content",defaultSize:100-P-R,minSize:30,children:t.jsxs(ct,{orientation:"vertical",children:[t.jsx(ze,{id:"editor",defaultSize:p?70:100,minSize:20,children:t.jsx("div",{className:"h-full overflow-hidden",children:x&&y?y:i})}),!x&&d&&m&&N&&t.jsxs(t.Fragment,{children:[t.jsx(sn,{}),t.jsx(ze,{id:"bottom-panel",panelRef:b,defaultSize:p?30:0,minSize:0,maxSize:50,collapsible:!0,collapsedSize:0,onResize:T,children:t.jsxs("div",{className:"h-full flex flex-col bg-[var(--color-bg-secondary)]",children:[t.jsx(nn,{isOpen:p,onToggle:C,activeTab:g,onTabChange:N}),t.jsx("div",{className:"flex-1 overflow-hidden",children:d})]})})]})]})}),!x&&f&&u&&t.jsxs(t.Fragment,{children:[t.jsx(er,{}),t.jsx(ze,{id:"right-sidebar",defaultSize:R,minSize:15,maxSize:40,onResize:I,className:"overflow-hidden",children:t.jsx("div",{className:"h-full border-l border-[var(--color-border)]",children:f})})]})]})]})}function Sr({node:e,level:r,selectedPath:a,expandedPaths:s,onSelect:n,onToggle:i}){const f=s.has(e.path),l=a===e.path,c=e.type==="directory",u=e.name.endsWith(".md"),d=()=>{c?i(e.path):n(e.path)};return t.jsxs("div",{children:[t.jsxs("button",{onClick:d,className:L("flex w-full items-center gap-1.5 rounded-md px-2 py-1 text-left text-xs transition-colors",l?"bg-[var(--color-accent-primary)]/10 text-[var(--color-accent-primary)]":"text-[var(--color-text-secondary)] hover:bg-[var(--color-bg-secondary)] hover:text-[var(--color-text-primary)]"),style:{paddingLeft:`${r*12+8}px`},children:[c?t.jsxs(t.Fragment,{children:[f?t.jsx(Ge,{className:"h-3 w-3 flex-shrink-0 text-[var(--color-text-muted)]"}):t.jsx(Je,{className:"h-3 w-3 flex-shrink-0 text-[var(--color-text-muted)]"}),f?t.jsx(lr,{className:"h-3.5 w-3.5 flex-shrink-0 text-[var(--color-warning)]"}):t.jsx(sr,{className:"h-3.5 w-3.5 flex-shrink-0 text-[var(--color-warning)]"})]}):t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"w-3"}),u?t.jsx(je,{className:"h-3.5 w-3.5 flex-shrink-0 text-[var(--color-accent-secondary)]"}):t.jsx(Oe,{className:"h-3.5 w-3.5 flex-shrink-0 text-[var(--color-text-muted)]"})]}),t.jsx("span",{className:"truncate",children:e.name})]}),c&&f&&e.children&&t.jsx("div",{children:e.children.map(v=>t.jsx(Sr,{node:v,level:r+1,selectedPath:a,expandedPaths:s,onSelect:n,onToggle:i},v.path))})]})}function ln({projectId:e,systemPromptParams:r,onClose:a}){const[s,n]=o.useState([]),[i,f]=o.useState(!0),[l,c]=o.useState(null),[u,d]=o.useState("system_prompt"),[v,h]=o.useState(new Set),[p,m]=o.useState(""),[x,y]=o.useState(!1),[g,N]=o.useState(!1),[j,b]=o.useState(!1);o.useEffect(()=>{(async()=>{try{f(!0);const C=await Tt(e);n(C);const E=new Set;C.forEach(G=>{G.type==="directory"&&E.add(G.path)}),h(E)}catch(C){console.error("Failed to load skills tree:",C)}finally{f(!1)}})()},[e]),o.useEffect(()=>{(async()=>{try{y(!0);const C=await Lt(r);m(C),d("system_prompt")}catch(C){console.error("Failed to load system prompt:",C),m("Error loading system prompt")}finally{y(!1)}})()},[r]);const w=o.useCallback(async()=>{c(null),d("system_prompt"),y(!0);try{const T=await Lt(r);m(T)}catch(T){console.error("Failed to load system prompt:",T),m("Error loading system prompt")}finally{y(!1)}},[r]),P=o.useCallback(async T=>{c(T),d("skill"),y(!0);try{const C=await Ur(e,T);m(C.content)}catch(C){console.error("Failed to load skill file:",C),m("Error loading file")}finally{y(!1)}},[e]),R=o.useCallback(T=>{h(C=>{const E=new Set(C);return E.has(T)?E.delete(T):E.add(T),E})},[]),z=o.useCallback(async()=>{b(!0);try{await Kr(e);const T=await Tt(e);n(T);const C=new Set;T.forEach(E=>{E.type==="directory"&&C.add(E.path)}),h(C),c(null),d("system_prompt")}catch(T){console.error("Failed to reload skills:",T)}finally{b(!1)}},[e]),I=u==="system_prompt"||(l==null?void 0:l.endsWith(".md"));return t.jsxs("div",{className:"fixed inset-0 z-50 flex",children:[t.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:a}),t.jsxs("div",{className:"relative z-10 flex w-full h-full m-4 rounded-xl border border-[var(--color-border)] bg-[var(--color-background)] shadow-2xl overflow-hidden",children:[t.jsxs("div",{className:"w-64 flex-shrink-0 border-r border-[var(--color-border)] bg-[var(--color-bg-secondary)]/30 flex flex-col",children:[t.jsx("div",{className:"flex items-center justify-between px-4 py-3 border-b border-[var(--color-border)]",children:t.jsx("h2",{className:"text-sm font-semibold text-[var(--color-text-heading)]",children:"Documentation"})}),t.jsxs("div",{className:"flex-1 overflow-y-auto p-2",children:[t.jsxs("button",{onClick:w,className:L("flex w-full items-center gap-2 rounded-md px-2 py-1.5 text-left text-xs transition-colors mb-2",u==="system_prompt"?"bg-[var(--color-accent-primary)]/10 text-[var(--color-accent-primary)]":"text-[var(--color-text-secondary)] hover:bg-[var(--color-bg-secondary)] hover:text-[var(--color-text-primary)]"),children:[t.jsx(nt,{className:"h-3.5 w-3.5 flex-shrink-0"}),t.jsx("span",{className:"font-medium",children:"System Prompt"})]}),t.jsx("div",{className:"my-2 border-t border-[var(--color-border)]"}),t.jsxs("button",{onClick:z,disabled:j,className:"flex w-full items-center justify-center gap-2 rounded-lg px-3 py-2 text-xs font-medium bg-blue-600 text-white hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed mb-3 shadow-sm",children:[t.jsx(Le,{className:L("h-3.5 w-3.5 flex-shrink-0",j&&"animate-spin")}),t.jsx("span",{children:j?"Reloading...":"Reload project skills"})]}),t.jsx("div",{className:"px-2 py-1 text-[10px] font-semibold uppercase tracking-wider text-[var(--color-text-muted)]",children:"Skills"}),i?t.jsx("div",{className:"flex items-center justify-center py-8",children:t.jsx(ye,{className:"h-4 w-4 animate-spin text-[var(--color-text-muted)]"})}):s.length===0?t.jsx("div",{className:"px-2 py-4 text-xs text-[var(--color-text-muted)]",children:"No skills available"}):t.jsx("div",{className:"space-y-0.5",children:s.map(T=>t.jsx(Sr,{node:T,level:0,selectedPath:l,expandedPaths:v,onSelect:P,onToggle:R},T.path))})]})]}),t.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[t.jsxs("div",{className:"flex items-center justify-between px-5 py-3 border-b border-[var(--color-border)]",children:[t.jsx("div",{className:"flex items-center gap-2 min-w-0",children:u==="system_prompt"?t.jsxs(t.Fragment,{children:[t.jsx(nt,{className:"h-4 w-4 flex-shrink-0 text-[var(--color-accent-primary)]"}),t.jsxs("div",{className:"min-w-0",children:[t.jsx("h3",{className:"text-sm font-semibold text-[var(--color-text-heading)] truncate",children:"System Prompt"}),t.jsx("p",{className:"text-xs text-[var(--color-text-muted)]",children:"Instructions injected to Claude Code"})]})]}):t.jsxs(t.Fragment,{children:[t.jsx(je,{className:"h-4 w-4 flex-shrink-0 text-[var(--color-accent-secondary)]"}),t.jsxs("div",{className:"min-w-0",children:[t.jsx("h3",{className:"text-sm font-semibold text-[var(--color-text-heading)] truncate",children:(l==null?void 0:l.split("/").pop())||"Select a file"}),t.jsx("p",{className:"text-xs text-[var(--color-text-muted)] truncate",children:l||"Choose a skill file from the sidebar"})]})]})}),t.jsxs("div",{className:"flex items-center gap-2",children:[I&&t.jsx("button",{onClick:()=>N(!g),className:L("flex items-center gap-1 px-2 py-1 rounded-md text-xs transition-colors",g?"bg-[var(--color-accent-primary)]/10 text-[var(--color-accent-primary)]":"text-[var(--color-text-muted)] hover:text-[var(--color-text-primary)] hover:bg-[var(--color-bg-secondary)]"),children:g?t.jsxs(t.Fragment,{children:[t.jsx(Xa,{className:"h-3 w-3"}),"Rendered"]}):t.jsxs(t.Fragment,{children:[t.jsx(ua,{className:"h-3 w-3"}),"Raw"]})}),t.jsx("button",{onClick:a,className:"p-1 rounded-md text-[var(--color-text-muted)] hover:text-[var(--color-text-primary)] hover:bg-[var(--color-bg-secondary)] transition-colors",children:t.jsx(Ae,{className:"h-4 w-4"})})]})]}),t.jsx("div",{className:"flex-1 overflow-y-auto p-5",children:x?t.jsx("div",{className:"flex items-center justify-center py-20",children:t.jsxs("div",{className:"flex flex-col items-center gap-3",children:[t.jsx(ye,{className:"h-6 w-6 animate-spin text-[var(--color-accent-primary)]"}),t.jsx("p",{className:"text-xs text-[var(--color-text-muted)]",children:"Loading..."})]})}):g||!I?t.jsx("pre",{className:"text-xs font-mono text-[var(--color-text-primary)] whitespace-pre-wrap break-words bg-[var(--color-bg-secondary)]/50 p-4 rounded-lg border border-[var(--color-border)]",children:p}):t.jsx("div",{className:"prose prose-xs max-w-none text-[var(--color-text-primary)] text-xs leading-relaxed",children:t.jsx(Hr,{remarkPlugins:[Vr],children:p})})})]})]})]})}const xe={FILE:"File",VIEW:"View",TERMINAL:"Terminal",SEARCH:"Search"};function cn(e){const r=navigator.platform.toUpperCase().indexOf("MAC")>=0;return e.replace("Cmd",r?"⌘":"Ctrl").replace("Alt",r?"⌥":"Alt").replace("Shift",r?"⇧":"Shift").replace("+"," ")}function dn({isOpen:e,onClose:r,commands:a}){const[s,n]=o.useState(""),[i,f]=o.useState(0),l=o.useRef(null),c=o.useRef(null),u=s?a.filter(h=>h.label.toLowerCase().includes(s.toLowerCase())||h.id.toLowerCase().includes(s.toLowerCase())||h.category&&h.category.toLowerCase().includes(s.toLowerCase())):a;o.useEffect(()=>{e&&(n(""),f(0),setTimeout(()=>{var h;return(h=l.current)==null?void 0:h.focus()},10))},[e]),o.useEffect(()=>{f(0)},[s]),o.useEffect(()=>{if(c.current){const h=c.current.children[i];h&&h.scrollIntoView({block:"nearest"})}},[i]);const d=o.useCallback(h=>{switch(h.key){case"ArrowDown":h.preventDefault(),f(p=>p<u.length-1?p+1:p);break;case"ArrowUp":h.preventDefault(),f(p=>p>0?p-1:p);break;case"Enter":h.preventDefault(),u[i]&&(u[i].action(),r());break;case"Escape":h.preventDefault(),r();break}},[u,i,r]),v=o.useCallback(h=>{h.action(),r()},[r]);return e?t.jsxs("div",{className:"fixed inset-0 z-50 flex items-start justify-center pt-[20vh]",children:[t.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:r}),t.jsxs("div",{className:"relative w-full max-w-lg bg-[var(--color-background)] border border-[var(--color-border)] rounded-lg shadow-xl overflow-hidden",children:[t.jsxs("div",{className:"flex items-center gap-2 px-3 border-b border-[var(--color-border)]",children:[t.jsx(Ua,{className:"h-4 w-4 text-[var(--color-text-muted)]"}),t.jsx("input",{ref:l,type:"text",value:s,onChange:h=>n(h.target.value),onKeyDown:d,placeholder:"Type a command or search...",className:"flex-1 h-12 bg-transparent text-sm text-[var(--color-text-primary)] placeholder:text-[var(--color-text-muted)] focus:outline-none"}),t.jsx("button",{onClick:r,className:"p-1 rounded hover:bg-[var(--color-bg-secondary)] text-[var(--color-text-muted)] hover:text-[var(--color-text-primary)]",children:t.jsx(Ae,{className:"h-4 w-4"})})]}),t.jsx("div",{ref:c,className:"max-h-80 overflow-y-auto py-2",children:u.length===0?t.jsx("div",{className:"px-3 py-8 text-center text-sm text-[var(--color-text-muted)]",children:"No commands found"}):u.map((h,p)=>t.jsxs("button",{onClick:()=>v(h),className:L("w-full flex items-center justify-between px-3 py-2 text-sm transition-colors",p===i?"bg-[var(--color-accent-primary)]/10 text-[var(--color-text-primary)]":"text-[var(--color-text-secondary)] hover:bg-[var(--color-bg-secondary)]"),children:[t.jsxs("div",{className:"flex items-center gap-2",children:[h.category&&t.jsx("span",{className:"text-xs text-[var(--color-text-muted)]",children:h.category}),t.jsx("span",{children:h.label})]}),h.shortcut&&t.jsx("span",{className:"text-xs text-[var(--color-text-muted)] font-mono",children:cn(h.shortcut)})]},h.id))})]})]}):null}function Nr(e,r=""){const a=[];for(const s of e){const n=r?`${r}/${s.name}`:s.name;s.type==="file"&&a.push({path:n,name:s.name}),s.children&&a.push(...Nr(s.children,n))}return a}function tr(e,r){const a=e.toLowerCase(),s=r.toLowerCase();if(s===a)return{match:!0,score:100};if(s.includes(a))return{match:!0,score:80-s.indexOf(a)};let n=0,i=0;for(let f=0;f<s.length&&n<a.length;f++)s[f]===a[n]&&(n++,i+=1);return n===a.length?{match:!0,score:i}:{match:!1,score:0}}function un(e){const r=Ie(e),a={py:"text-blue-400",js:"text-yellow-400",jsx:"text-yellow-400",ts:"text-blue-400",tsx:"text-blue-400",json:"text-orange-400",yaml:"text-purple-400",yml:"text-purple-400",md:"text-gray-400",sql:"text-green-400"};return t.jsx(Oe,{className:L("h-4 w-4",a[r]||"text-gray-400")})}function fn({isOpen:e,onClose:r,files:a,onFileSelect:s}){const[n,i]=o.useState(""),[f,l]=o.useState(0),c=o.useRef(null),u=o.useRef(null),d=o.useMemo(()=>Nr(a),[a]),v=o.useMemo(()=>n?d.map(m=>{const x=tr(n,m.path),y=tr(n,m.name),g=Math.max(x.score,y.score*1.5);return{...m,score:g,match:x.match||y.match}}).filter(m=>m.match).sort((m,x)=>x.score-m.score).slice(0,50):d.slice(0,50),[d,n]);o.useEffect(()=>{e&&(i(""),l(0),setTimeout(()=>{var m;return(m=c.current)==null?void 0:m.focus()},10))},[e]),o.useEffect(()=>{l(0)},[n]),o.useEffect(()=>{if(u.current){const m=u.current.children[f];m&&m.scrollIntoView({block:"nearest"})}},[f]);const h=o.useCallback(m=>{switch(m.key){case"ArrowDown":m.preventDefault(),l(x=>x<v.length-1?x+1:x);break;case"ArrowUp":m.preventDefault(),l(x=>x>0?x-1:x);break;case"Enter":m.preventDefault(),v[f]&&(s(v[f].path),r());break;case"Escape":m.preventDefault(),r();break}},[v,f,s,r]),p=o.useCallback(m=>{s(m),r()},[s,r]);return e?t.jsxs("div",{className:"fixed inset-0 z-50 flex items-start justify-center pt-[20vh]",children:[t.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:r}),t.jsxs("div",{className:"relative w-full max-w-lg bg-[var(--color-background)] border border-[var(--color-border)] rounded-lg shadow-xl overflow-hidden",children:[t.jsxs("div",{className:"flex items-center gap-2 px-3 border-b border-[var(--color-border)]",children:[t.jsx(ft,{className:"h-4 w-4 text-[var(--color-text-muted)]"}),t.jsx("input",{ref:c,type:"text",value:n,onChange:m=>i(m.target.value),onKeyDown:h,placeholder:"Search files by name...",className:"flex-1 h-12 bg-transparent text-sm text-[var(--color-text-primary)] placeholder:text-[var(--color-text-muted)] focus:outline-none"}),t.jsx("button",{onClick:r,className:"p-1 rounded hover:bg-[var(--color-bg-secondary)] text-[var(--color-text-muted)] hover:text-[var(--color-text-primary)]",children:t.jsx(Ae,{className:"h-4 w-4"})})]}),t.jsx("div",{ref:u,className:"max-h-80 overflow-y-auto py-2",children:v.length===0?t.jsx("div",{className:"px-3 py-8 text-center text-sm text-[var(--color-text-muted)]",children:n?"No files found":"No files in project"}):v.map((m,x)=>t.jsxs("button",{onClick:()=>p(m.path),className:L("w-full flex items-center gap-2 px-3 py-2 text-sm transition-colors",x===f?"bg-[var(--color-accent-primary)]/10 text-[var(--color-text-primary)]":"text-[var(--color-text-secondary)] hover:bg-[var(--color-bg-secondary)]"),children:[un(m.name),t.jsx("span",{className:"truncate",children:m.name}),t.jsx("span",{className:"ml-auto text-xs text-[var(--color-text-muted)] truncate max-w-[200px]",children:m.path})]},m.path))})]})]}):null}function mn(e){const r=Ie(e),a={py:"text-blue-400",js:"text-yellow-400",jsx:"text-yellow-400",ts:"text-blue-400",tsx:"text-blue-400",json:"text-orange-400",yaml:"text-purple-400",yml:"text-purple-400",md:"text-gray-400",sql:"text-green-400"};return t.jsx(Oe,{className:L("h-3.5 w-3.5 flex-shrink-0",a[r]||"text-gray-400")})}function hn({results:e,onResultSelect:r,className:a=""}){const[s,n]=o.useState(new Set),i=o.useMemo(()=>{const c={};for(const d of e)c[d.path]||(c[d.path]={path:d.path,matches:[]}),c[d.path].matches.push(d);const u=Object.keys(c);return s.size===0&&u.length>0&&n(new Set(u)),Object.values(c)},[e]),f=c=>{n(u=>{const d=new Set(u);return d.has(c)?d.delete(c):d.add(c),d})},l=(c,u,d)=>{const v=c.slice(0,u),h=c.slice(u,d),p=c.slice(d);return t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"text-[var(--color-text-muted)]",children:v}),t.jsx("span",{className:"bg-[var(--color-accent-primary)]/30 text-[var(--color-accent-primary)]",children:h}),t.jsx("span",{className:"text-[var(--color-text-muted)]",children:p})]})};return t.jsx("div",{className:L("text-xs",a),children:i.map(c=>{const u=s.has(c.path),d=c.path.split("/").pop()||c.path;return t.jsxs("div",{children:[t.jsxs("button",{onClick:()=>f(c.path),className:"w-full flex items-center gap-1 px-2 py-1 hover:bg-[var(--color-bg-secondary)] text-left",children:[u?t.jsx(Ge,{className:"h-3 w-3 text-[var(--color-text-muted)]"}):t.jsx(Je,{className:"h-3 w-3 text-[var(--color-text-muted)]"}),mn(d),t.jsx("span",{className:"text-[var(--color-text-primary)] truncate",children:d}),t.jsx("span",{className:"ml-auto text-[var(--color-text-muted)]",children:c.matches.length})]}),u&&t.jsx("div",{className:"ml-4",children:c.matches.map((v,h)=>t.jsxs("button",{onClick:()=>r(v.path,v.line_number),className:"w-full flex items-start gap-2 px-2 py-1 hover:bg-[var(--color-bg-secondary)] text-left group",children:[t.jsx("span",{className:"text-[var(--color-text-muted)] w-8 text-right flex-shrink-0",children:v.line_number}),t.jsx("span",{className:"truncate font-mono",children:l(v.line_content.trim(),v.match_start,v.match_end)})]},`${v.path}-${v.line_number}-${h}`))})]},c.path)})})}function xn({projectId:e,onResultSelect:r,className:a=""}){const[s,n]=o.useState(""),[i,f]=o.useState(!1),[l,c]=o.useState(!1),[u,d]=o.useState(""),[v,h]=o.useState(!1),[p,m]=o.useState([]),[x,y]=o.useState(!1),[g,N]=o.useState(null),j=o.useRef(null),b=o.useRef(null),w=o.useCallback(async R=>{if(!R.trim()){m([]);return}y(!0),N(null);try{const z=await Jr(e,{query:R,caseSensitive:i,regex:l,glob:u||void 0});m(z)}catch(z){N(z instanceof Error?z.message:"Search failed"),m([])}finally{y(!1)}},[e,i,l,u]);o.useEffect(()=>(b.current&&clearTimeout(b.current),b.current=setTimeout(()=>{w(s)},300),()=>{b.current&&clearTimeout(b.current)}),[s,w]),o.useEffect(()=>{s.trim()&&w(s)},[i,l,u]);const P=R=>{R.key==="Escape"&&(n(""),m([]))};return t.jsxs("div",{className:L("flex flex-col h-full",a),children:[t.jsxs("div",{className:"flex-shrink-0 p-2 border-b border-[var(--color-border)]",children:[t.jsx("div",{className:"flex items-center gap-1",children:t.jsxs("div",{className:"relative flex-1",children:[t.jsx(ft,{className:"absolute left-2 top-1/2 -translate-y-1/2 h-3.5 w-3.5 text-[var(--color-text-muted)]"}),t.jsx("input",{ref:j,type:"text",value:s,onChange:R=>n(R.target.value),onKeyDown:P,placeholder:"Search in files...",className:"w-full h-7 pl-7 pr-2 rounded-md border border-[var(--color-border)] bg-[var(--color-background)] text-xs text-[var(--color-text-primary)] placeholder:text-[var(--color-text-muted)] focus:outline-none focus:ring-1 focus:ring-[var(--color-accent-primary)]/50"}),s&&t.jsx("button",{onClick:()=>{n(""),m([])},className:"absolute right-2 top-1/2 -translate-y-1/2 text-[var(--color-text-muted)] hover:text-[var(--color-text-primary)]",children:t.jsx(Ae,{className:"h-3 w-3"})})]})}),t.jsxs("div",{className:"flex items-center gap-1 mt-2",children:[t.jsx("button",{onClick:()=>f(!i),className:L("flex items-center justify-center h-6 w-6 rounded transition-colors",i?"bg-[var(--color-accent-primary)]/20 text-[var(--color-accent-primary)]":"text-[var(--color-text-muted)] hover:text-[var(--color-text-primary)] hover:bg-[var(--color-bg-secondary)]"),title:"Match case",children:t.jsx(Ia,{className:"h-3.5 w-3.5"})}),t.jsx("button",{onClick:()=>c(!l),className:L("flex items-center justify-center h-6 w-6 rounded transition-colors",l?"bg-[var(--color-accent-primary)]/20 text-[var(--color-accent-primary)]":"text-[var(--color-text-muted)] hover:text-[var(--color-text-primary)] hover:bg-[var(--color-bg-secondary)]"),title:"Use regular expression",children:t.jsx(ys,{className:"h-3.5 w-3.5"})}),t.jsx("button",{onClick:()=>h(!v),className:L("flex items-center justify-center h-6 w-6 rounded transition-colors",v||u?"bg-[var(--color-accent-primary)]/20 text-[var(--color-accent-primary)]":"text-[var(--color-text-muted)] hover:text-[var(--color-text-primary)] hover:bg-[var(--color-bg-secondary)]"),title:"Filter files",children:t.jsx(ss,{className:"h-3.5 w-3.5"})}),t.jsx("span",{className:"ml-auto text-[10px] text-[var(--color-text-muted)]",children:x?"Searching...":p.length>0?`${p.length} results`:""})]}),v&&t.jsx("div",{className:"mt-2",children:t.jsx("input",{type:"text",value:u,onChange:R=>d(R.target.value),placeholder:"File filter (e.g., *.py, src/**/*.ts)",className:"w-full h-7 px-2 rounded-md border border-[var(--color-border)] bg-[var(--color-background)] text-xs text-[var(--color-text-primary)] placeholder:text-[var(--color-text-muted)] focus:outline-none focus:ring-1 focus:ring-[var(--color-accent-primary)]/50"})})]}),t.jsx("div",{className:"flex-1 overflow-y-auto",children:g?t.jsx("div",{className:"p-3 text-xs text-red-400",children:g}):p.length===0&&s?t.jsx("div",{className:"p-3 text-xs text-[var(--color-text-muted)] text-center",children:x?"Searching...":"No results found"}):p.length===0?t.jsx("div",{className:"p-3 text-xs text-[var(--color-text-muted)] text-center",children:"Enter a search term to find in files"}):t.jsx(hn,{results:p,onResultSelect:r})})]})}const me="/api";function pn({projectId:e,onOpenDiff:r,className:a=""}){var le,ie,Te;const[s,n]=o.useState(null),[i,f]=o.useState([]),[l,c]=o.useState([]),[u,d]=o.useState(""),[v,h]=o.useState(!1),[p,m]=o.useState(null),[x,y]=o.useState(null),[g,N]=o.useState("changes"),[j,b]=o.useState(!1),[w,P]=o.useState({staged:!0,changes:!0,untracked:!0}),R=o.useRef(null),z=o.useCallback(async()=>{try{const k=await fetch(`${me}/projects/${e}/git/status`);if(!k.ok){const ae=await k.json().catch(()=>({detail:"Failed to get git status"}));throw new Error(ae.detail)}const F=await k.json();n(F),y(null)}catch(k){y(k instanceof Error?k.message:"Failed to get git status")}},[e]),I=o.useCallback(async()=>{try{const k=await fetch(`${me}/projects/${e}/git/log?limit=30`);if(!k.ok)return;const F=await k.json();f(F.commits||[])}catch{}},[e]),T=o.useCallback(async()=>{try{const k=await fetch(`${me}/projects/${e}/git/branches`);if(!k.ok)return;const F=await k.json();c(F.branches||[])}catch{}},[e]);o.useEffect(()=>{h(!0),Promise.all([z(),I(),T()]).finally(()=>h(!1))},[z,I,T]),o.useEffect(()=>{R.current=setInterval(()=>{document.hidden||z()},3e4);const k=()=>{!document.hidden&&R.current&&z()};return document.addEventListener("visibilitychange",k),()=>{R.current&&clearInterval(R.current),document.removeEventListener("visibilitychange",k)}},[z]);const C=o.useCallback(async()=>{h(!0),await Promise.all([z(),I(),T()]),h(!1)},[z,I,T]),E=o.useCallback(async k=>{m("stage");try{const F=await fetch(`${me}/projects/${e}/git/stage`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({files:k})});if(!F.ok){const ae=await F.json().catch(()=>({detail:"Stage failed"}));throw new Error(ae.detail)}await z()}catch(F){y(F instanceof Error?F.message:"Stage failed")}finally{m(null)}},[e,z]),G=o.useCallback(async k=>{m("unstage");try{const F=await fetch(`${me}/projects/${e}/git/unstage`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({files:k})});if(!F.ok){const ae=await F.json().catch(()=>({detail:"Unstage failed"}));throw new Error(ae.detail)}await z()}catch(F){y(F instanceof Error?F.message:"Unstage failed")}finally{m(null)}},[e,z]),K=o.useCallback(async()=>{if(u.trim()){m("commit");try{const k=await fetch(`${me}/projects/${e}/git/commit`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:u})});if(!k.ok){const F=await k.json().catch(()=>({detail:"Commit failed"}));throw new Error(F.detail)}d(""),await Promise.all([z(),I()])}catch(k){y(k instanceof Error?k.message:"Commit failed")}finally{m(null)}}},[e,u,z,I]),U=o.useCallback(async()=>{m("push");try{const k=await fetch(`${me}/projects/${e}/git/push`,{method:"POST"});if(!k.ok){const F=await k.json().catch(()=>({detail:"Push failed"}));throw new Error(F.detail)}await z()}catch(k){y(k instanceof Error?k.message:"Push failed")}finally{m(null)}},[e,z]),M=o.useCallback(async()=>{m("pull");try{const k=await fetch(`${me}/projects/${e}/git/pull`,{method:"POST"});if(!k.ok){const F=await k.json().catch(()=>({detail:"Pull failed"}));throw new Error(F.detail)}await Promise.all([z(),I()])}catch(k){y(k instanceof Error?k.message:"Pull failed")}finally{m(null)}},[e,z,I]),D=o.useCallback(async k=>{m("checkout"),b(!1);try{const F=await fetch(`${me}/projects/${e}/git/checkout`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({branch:k})});if(!F.ok){const ae=await F.json().catch(()=>({detail:"Checkout failed"}));throw new Error(ae.detail)}await C()}catch(F){y(F instanceof Error?F.message:"Checkout failed")}finally{m(null)}},[e,C]),B=o.useCallback(async k=>{if(r)try{const F=k.status==="staged",ae=await fetch(`${me}/projects/${e}/git/diff?file=${encodeURIComponent(k.path)}&staged=${F}`);if(!ae.ok)return;const ue=await ae.json();r(k.path,ue.diff||"")}catch{}},[e,r]),$=k=>{P(F=>({...F,[k]:!F[k]}))},H=((le=s==null?void 0:s.files)==null?void 0:le.filter(k=>k.status==="staged"||k.status==="staged+modified"))||[],J=((ie=s==null?void 0:s.files)==null?void 0:ie.filter(k=>k.status==="modified"||k.status==="staged+modified"))||[],X=((Te=s==null?void 0:s.files)==null?void 0:Te.filter(k=>k.status==="untracked"))||[],Y=k=>{switch(k){case"A":return"text-green-400";case"D":return"text-red-400";case"M":return"text-yellow-400";case"R":return"text-blue-400";case"U":return"text-gray-400";default:return"text-gray-400"}};return v&&!s?t.jsx("div",{className:L("flex items-center justify-center h-full",a),children:t.jsx(ye,{className:"h-5 w-5 animate-spin text-[var(--color-text-muted)]"})}):t.jsxs("div",{className:L("flex flex-col h-full text-sm",a),children:[t.jsxs("div",{className:"flex items-center justify-between px-3 h-9 border-b border-[var(--color-border)] flex-shrink-0",children:[t.jsx("span",{className:"text-xs font-semibold text-[var(--color-text-primary)] uppercase tracking-wider",children:"Source Control"}),t.jsx("div",{className:"flex items-center gap-1",children:t.jsx("button",{onClick:C,className:"p-1 text-[var(--color-text-muted)] hover:text-[var(--color-text-primary)] transition-colors",title:"Refresh",children:t.jsx(Le,{className:L("h-3.5 w-3.5",v&&"animate-spin")})})})]}),t.jsxs("div",{className:"flex items-center gap-1 px-3 py-1.5 border-b border-[var(--color-border)] flex-shrink-0",children:[t.jsxs("div",{className:"relative flex-1",children:[t.jsxs("button",{onClick:()=>{b(!j),j||T()},className:"flex items-center gap-1.5 text-xs text-[var(--color-text-primary)] hover:text-[var(--color-accent-primary)] transition-colors",children:[t.jsx(ar,{className:"h-3.5 w-3.5"}),t.jsx("span",{className:"truncate",children:(s==null?void 0:s.branch)||"main"}),t.jsx(Ge,{className:"h-3 w-3"})]}),j&&t.jsx("div",{className:"absolute top-full left-0 mt-1 w-56 bg-[var(--color-bg-secondary)] border border-[var(--color-border)] rounded shadow-lg z-50 max-h-48 overflow-y-auto",children:l.map(k=>t.jsxs("button",{onClick:()=>D(k.name),className:L("w-full text-left px-3 py-1.5 text-xs hover:bg-[var(--color-background)] transition-colors truncate",k.current?"text-[var(--color-accent-primary)] font-medium":"text-[var(--color-text-primary)]"),children:[k.current&&t.jsx($t,{className:"h-3 w-3 inline mr-1"}),k.name]},k.name))})]}),t.jsxs("button",{onClick:M,disabled:p==="pull",className:"flex items-center gap-0.5 px-1.5 py-0.5 text-[10px] text-[var(--color-text-muted)] hover:text-[var(--color-text-primary)] hover:bg-[var(--color-background)] rounded transition-colors disabled:opacity-50",title:"Pull",children:[t.jsx($a,{className:"h-3 w-3"}),((s==null?void 0:s.behind)??0)>0&&t.jsx("span",{children:s==null?void 0:s.behind})]}),t.jsxs("button",{onClick:U,disabled:p==="push",className:"flex items-center gap-0.5 px-1.5 py-0.5 text-[10px] text-[var(--color-text-muted)] hover:text-[var(--color-text-primary)] hover:bg-[var(--color-background)] rounded transition-colors disabled:opacity-50",title:"Push",children:[t.jsx(Aa,{className:"h-3 w-3"}),((s==null?void 0:s.ahead)??0)>0&&t.jsx("span",{children:s==null?void 0:s.ahead})]})]}),t.jsxs("div",{className:"flex items-center border-b border-[var(--color-border)] flex-shrink-0",children:[t.jsxs("button",{onClick:()=>N("changes"),className:L("flex items-center gap-1 px-3 py-1.5 text-xs transition-colors",g==="changes"?"text-[var(--color-text-primary)] border-b-2 border-[var(--color-accent-primary)]":"text-[var(--color-text-muted)] hover:text-[var(--color-text-primary)]"),children:[t.jsx(je,{className:"h-3 w-3"}),"Changes"]}),t.jsxs("button",{onClick:()=>{N("log"),I()},className:L("flex items-center gap-1 px-3 py-1.5 text-xs transition-colors",g==="log"?"text-[var(--color-text-primary)] border-b-2 border-[var(--color-accent-primary)]":"text-[var(--color-text-muted)] hover:text-[var(--color-text-primary)]"),children:[t.jsx(cs,{className:"h-3 w-3"}),"Log"]})]}),x&&t.jsxs("div",{className:"px-3 py-2 text-xs text-red-400 bg-red-400/10 border-b border-[var(--color-border)]",children:[x,t.jsx("button",{onClick:()=>y(null),className:"ml-2 underline",children:"dismiss"})]}),g==="changes"?t.jsxs("div",{className:"flex-1 overflow-y-auto",children:[t.jsxs("div",{className:"px-3 py-2 border-b border-[var(--color-border)]",children:[t.jsx("textarea",{value:u,onChange:k=>d(k.target.value),placeholder:"Commit message",className:"w-full px-2 py-1.5 text-xs bg-[var(--color-background)] border border-[var(--color-border)] rounded text-[var(--color-text-primary)] placeholder:text-[var(--color-text-muted)] resize-none focus:outline-none focus:border-[var(--color-accent-primary)]",rows:3,onKeyDown:k=>{k.key==="Enter"&&(k.metaKey||k.ctrlKey)&&K()}}),t.jsxs("button",{onClick:K,disabled:!u.trim()||H.length===0||p==="commit",className:"mt-1.5 w-full flex items-center justify-center gap-1.5 px-3 py-1.5 text-xs font-medium bg-[var(--color-accent-primary)] text-white rounded hover:bg-[var(--color-accent-primary)]/80 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[p==="commit"?t.jsx(ye,{className:"h-3 w-3 animate-spin"}):t.jsx($t,{className:"h-3 w-3"}),"Commit (",H.length," staged)"]})]}),H.length>0&&t.jsx(st,{title:"Staged Changes",count:H.length,expanded:w.staged,onToggle:()=>$("staged"),files:H,onAction:k=>G([k.path]),actionIcon:t.jsx(xs,{className:"h-3 w-3"}),actionTitle:"Unstage",statusBadgeColor:Y,onFileClick:B}),J.length>0&&t.jsx(st,{title:"Changes",count:J.length,expanded:w.changes,onToggle:()=>$("changes"),files:J,onAction:k=>E([k.path]),actionIcon:t.jsx(ot,{className:"h-3 w-3"}),actionTitle:"Stage",statusBadgeColor:Y,onFileClick:B}),X.length>0&&t.jsx(st,{title:"Untracked",count:X.length,expanded:w.untracked,onToggle:()=>$("untracked"),files:X,onAction:k=>E([k.path]),actionIcon:t.jsx(ot,{className:"h-3 w-3"}),actionTitle:"Stage",statusBadgeColor:Y,onFileClick:B}),H.length===0&&J.length===0&&X.length===0&&t.jsx("div",{className:"px-3 py-8 text-center text-xs text-[var(--color-text-muted)]",children:"No changes detected"})]}):t.jsx("div",{className:"flex-1 overflow-y-auto",children:i.length===0?t.jsx("div",{className:"px-3 py-8 text-center text-xs text-[var(--color-text-muted)]",children:"No commits yet"}):i.map(k=>t.jsx("div",{className:"px-3 py-2 border-b border-[var(--color-border)] hover:bg-[var(--color-background)]/50 transition-colors",children:t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-[10px] font-mono text-[var(--color-accent-primary)] flex-shrink-0 mt-0.5",children:k.short_hash}),t.jsxs("div",{className:"min-w-0 flex-1",children:[t.jsx("div",{className:"text-xs text-[var(--color-text-primary)] truncate",children:k.message}),t.jsxs("div",{className:"text-[10px] text-[var(--color-text-muted)] mt-0.5",children:[k.author," - ",new Date(k.timestamp*1e3).toLocaleDateString()]})]})]})},k.hash))})]})}function st({title:e,count:r,expanded:a,onToggle:s,files:n,onAction:i,actionIcon:f,actionTitle:l,statusBadgeColor:c,onFileClick:u}){return t.jsxs("div",{children:[t.jsxs("button",{onClick:s,className:"flex items-center gap-1 w-full px-3 py-1.5 text-[11px] font-semibold text-[var(--color-text-muted)] hover:text-[var(--color-text-primary)] uppercase tracking-wider transition-colors",children:[a?t.jsx(Ge,{className:"h-3 w-3"}):t.jsx(Je,{className:"h-3 w-3"}),e,t.jsx("span",{className:"ml-auto text-[10px] font-normal bg-[var(--color-bg-secondary)] px-1.5 rounded",children:r})]}),a&&t.jsx("div",{children:n.map(d=>{const v=d.path.split("/").pop()||d.path,h=d.path.includes("/")?d.path.substring(0,d.path.lastIndexOf("/")):"";return t.jsxs("div",{className:"group flex items-center gap-1 px-3 py-1 hover:bg-[var(--color-background)]/50 transition-colors cursor-pointer",onClick:()=>u(d),children:[t.jsx("span",{className:L("text-[10px] font-mono w-4 text-center flex-shrink-0",c(d.change_type)),children:d.change_type}),t.jsx("span",{className:"text-xs text-[var(--color-text-primary)] truncate",children:v}),h&&t.jsx("span",{className:"text-[10px] text-[var(--color-text-muted)] truncate ml-1",children:h}),t.jsx("button",{onClick:p=>{p.stopPropagation(),i(d)},className:"ml-auto p-0.5 text-[var(--color-text-muted)] hover:text-[var(--color-text-primary)] opacity-0 group-hover:opacity-100 transition-all",title:l,children:f})]},`${d.path}-${d.status}`)})})]})}function vn({projectId:e,className:r=""}){const[a,s]=o.useState([{id:"welcome",type:"output",content:`Terminal ready. Working directory: /projects/${e}`,timestamp:new Date}]),[n,i]=o.useState(""),[f,l]=o.useState(!1),[c,u]=o.useState([]),[d,v]=o.useState(-1),h=o.useRef(null),p=o.useRef(null);o.useEffect(()=>{p.current&&(p.current.scrollTop=p.current.scrollHeight)},[a]);const m=o.useCallback(()=>{var g;(g=h.current)==null||g.focus()},[]),x=o.useCallback(async g=>{if(!g.trim())return;const N={id:`input-${Date.now()}`,type:"input",content:`$ ${g}`,timestamp:new Date};s(j=>[...j,N]),u(j=>[...j,g]),v(-1),l(!0);try{const j=await fetch(`/api/projects/${e}/terminal/execute`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({command:g})}),b=await j.json();if(b.stdout){const w={id:`output-${Date.now()}`,type:"output",content:b.stdout,timestamp:new Date};s(P=>[...P,w])}if(b.stderr){const w={id:`error-${Date.now()}`,type:"error",content:b.stderr,timestamp:new Date};s(P=>[...P,w])}if(!j.ok&&b.detail){const w={id:`error-${Date.now()}`,type:"error",content:b.detail,timestamp:new Date};s(P=>[...P,w])}}catch(j){const b={id:`error-${Date.now()}`,type:"error",content:j instanceof Error?j.message:"Command execution failed",timestamp:new Date};s(w=>[...w,b])}finally{l(!1)}},[e]),y=o.useCallback(g=>{if(g.key==="Enter"&&!f)x(n),i("");else if(g.key==="ArrowUp"){if(g.preventDefault(),c.length>0){const N=d<c.length-1?d+1:d;v(N),i(c[c.length-1-N]||"")}}else if(g.key==="ArrowDown")if(g.preventDefault(),d>0){const N=d-1;v(N),i(c[c.length-1-N]||"")}else d===0&&(v(-1),i(""));else g.key==="c"&&g.ctrlKey?(i(""),s(N=>[...N,{id:`interrupt-${Date.now()}`,type:"output",content:"^C",timestamp:new Date}])):g.key==="l"&&g.ctrlKey&&(g.preventDefault(),s([]))},[n,f,c,d,x]);return t.jsxs("div",{ref:p,className:L("h-full bg-[#1e1e1e] text-[#d4d4d4] font-mono text-xs overflow-y-auto p-2 cursor-text",r),onClick:m,children:[a.map(g=>t.jsx("div",{className:L("whitespace-pre-wrap break-all",g.type==="input"&&"text-[#569cd6]",g.type==="error"&&"text-[#f14c4c]",g.type==="output"&&"text-[#d4d4d4]"),children:g.content},g.id)),t.jsxs("div",{className:"flex items-center",children:[t.jsx("span",{className:"text-[#569cd6] mr-1",children:"$"}),t.jsx("input",{ref:h,type:"text",value:n,onChange:g=>i(g.target.value),onKeyDown:y,disabled:f,className:"flex-1 bg-transparent outline-none text-[#d4d4d4] caret-[#d4d4d4]",autoFocus:!0}),f&&t.jsx("span",{className:"animate-pulse ml-2 text-[#808080]",children:"Running..."})]})]})}var gn=fa(),yn=ma(),bn=ha();const we="/api";function wn({projectId:e,isMaximized:r=!1,onToggleMaximize:a,suggestedPrompts:s,className:n="",onFilesChanged:i}){const f=o.useRef(null),l=o.useRef(null),c=o.useRef(null),u=o.useRef(null),d=o.useRef(null),v=o.useRef(0),h=o.useRef(100),[p,m]=o.useState("connecting"),[x,y]=o.useState(null),[g,N]=o.useState(!1),j=o.useRef(!1),b=o.useRef(!1),w=o.useRef(null),P=o.useRef(0),R=o.useRef(""),z=o.useRef(null),I=o.useCallback(()=>{d.current&&(clearTimeout(d.current),d.current=null)},[]),T=o.useCallback(()=>{const M=R.current;R.current="",z.current=null;const D=u.current;!M||!D||fetch(`${we}/projects/${e}/pty/${D}/input`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({data:btoa(M)})}).catch(()=>{})},[e]),C=o.useCallback(async M=>{const D=l.current;if(!D)return;const{cols:B,rows:$}=D;try{(await fetch(`${we}/projects/${e}/pty/${M}/resize`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({cols:B,rows:$})})).ok||(console.warn("Resize failed, reconnecting terminal..."),w.current&&w.current())}catch(H){console.error("Resize error:",H),w.current&&w.current()}},[e]),E=o.useCallback(M=>{I(),h.current=50;const D=async()=>{var B,$;try{const H=h.current<200?3:1,J=await fetch(`${we}/projects/${e}/pty/${M}/output?timeout=${H}`,{method:"POST"});if(J.status===404){console.warn("Session lost (404), reconnecting..."),I(),w.current&&w.current();return}if(!J.ok)throw new Error(`HTTP ${J.status}`);const X=await J.json();if(v.current=0,X.output){h.current=50;const Y=atob(X.output),le=new Uint8Array(Y.length);for(let ie=0;ie<Y.length;ie++)le[ie]=Y.charCodeAt(ie);(B=l.current)==null||B.write(le)}else h.current=Math.min(h.current*2,2e3);X.files_modified_at&&X.files_modified_at>P.current&&(P.current=X.files_modified_at,i==null||i()),X.exited?(($=l.current)==null||$.writeln(`\r
\x1B[33m⚠ Process exited\x1B[0m`),m("disconnected"),I()):d.current=setTimeout(D,h.current)}catch{v.current++,v.current>=5?(m("error"),y("Connection lost"),I()):d.current=setTimeout(D,h.current)}};D()},[e,I,i]),G=o.useCallback(async()=>{var M,D,B;if(!(!l.current||j.current)){j.current=!0,m("connecting"),y(null);try{const $=await fetch(`${we}/projects/${e}/pty/create`,{method:"POST"});if(!$.ok){const J=await $.json().catch(()=>({detail:`HTTP ${$.status}`}));throw new Error(J.detail||`HTTP ${$.status}`)}const H=await $.json();u.current=H.session_id,m("connected"),(M=l.current)==null||M.writeln(`\x1B[32m✓ Connected (session ${H.session_id.slice(0,8)})\x1B[0m`),(D=l.current)==null||D.writeln(""),E(H.session_id),setTimeout(()=>{if(c.current)try{c.current.fit()}catch{}C(H.session_id)},100)}catch($){m("error"),y($ instanceof Error?$.message:String($)),(B=l.current)==null||B.writeln(`\x1B[31m✗ Error: ${$ instanceof Error?$.message:$}\x1B[0m`)}finally{j.current=!1}}},[e,E,C]);o.useEffect(()=>{if(!f.current||l.current)return;const M=new gn.Terminal({cursorBlink:!0,fontSize:13,fontFamily:"JetBrains Mono, Menlo, Monaco, Consolas, monospace",theme:{background:"#1e1e1e",foreground:"#d4d4d4",cursor:"#d4d4d4",cursorAccent:"#1e1e1e",selectionBackground:"#264f78",black:"#000000",red:"#cd3131",green:"#0dbc79",yellow:"#e5e510",blue:"#2472c8",magenta:"#bc3fbc",cyan:"#11a8cd",white:"#e5e5e5",brightBlack:"#666666",brightRed:"#f14c4c",brightGreen:"#23d18b",brightYellow:"#f5f543",brightBlue:"#3b8eea",brightMagenta:"#d670d6",brightCyan:"#29b8db",brightWhite:"#ffffff"},allowProposedApi:!0}),D=new yn.FitAddon,B=new bn.WebLinksAddon;return M.loadAddon(D),M.loadAddon(B),M.open(f.current),requestAnimationFrame(()=>{try{D.fit()}catch{}}),l.current=M,c.current=D,M.writeln("\x1B[1;34m╭─────────────────────────────────────────────────────╮\x1B[0m"),M.writeln("\x1B[1;34m│\x1B[0m  \x1B[1;33mClaude Code Terminal\x1B[0m                               \x1B[1;34m│\x1B[0m"),M.writeln("\x1B[1;34m│\x1B[0m  Connecting to Databricks-authenticated session...  \x1B[1;34m│\x1B[0m"),M.writeln("\x1B[1;34m╰─────────────────────────────────────────────────────╯\x1B[0m"),M.writeln(""),M.onData($=>{u.current&&(R.current+=$,h.current=50,z.current||(z.current=setTimeout(()=>{T()},15)))}),()=>{M.dispose(),l.current=null,c.current=null}},[]),o.useEffect(()=>{const M=setTimeout(()=>{l.current&&G()},100);return()=>{clearTimeout(M),I(),z.current&&(clearTimeout(z.current),z.current=null)}},[G,I,e]),o.useEffect(()=>{const M=()=>{const D=u.current;D&&navigator.sendBeacon(`${we}/projects/${e}/pty/${D}/terminate`,"")};return window.addEventListener("beforeunload",M),()=>window.removeEventListener("beforeunload",M)},[e]),o.useEffect(()=>{const M=()=>{if(c.current&&l.current)try{c.current.fit();const H=u.current;H&&C(H)}catch{}};let D;const B=()=>{clearTimeout(D),D=setTimeout(M,250)};window.addEventListener("resize",B);const $=new ResizeObserver(B);return f.current&&$.observe(f.current),()=>{window.removeEventListener("resize",B),$.disconnect(),clearTimeout(D)}},[C]);const K=o.useCallback(M=>{N(!0);const D=u.current;if(!D)return;const B=btoa(M+`
`);fetch(`${we}/projects/${e}/pty/${D}/input`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({data:B})}).catch(()=>{})},[e]),U=o.useCallback(()=>{if(b.current)return;b.current=!0,l.current&&l.current.write(`\r
\x1B[33mReconnecting session...\x1B[0m\r
`),I();const M=u.current;M&&(fetch(`${we}/projects/${e}/pty/${M}`,{method:"DELETE"}).catch(()=>{}),u.current=null),j.current=!1,G().then(()=>{b.current=!1}).catch(D=>{console.error("Reconnection failed:",D),b.current=!1,m("error")})},[G,e,I]);return w.current=U,t.jsxs("div",{className:L("relative h-full w-full flex flex-col",n),children:[t.jsxs("div",{className:"flex items-center justify-between h-8 px-3 bg-[#252526] border-b border-[#3c3c3c] flex-shrink-0",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-xs text-[#d4d4d4] font-medium",children:"Claude Code"}),t.jsxs("span",{className:L("inline-flex items-center gap-1 px-1.5 py-0.5 rounded text-[10px]",p==="connected"&&"bg-green-500/20 text-green-400",p==="connecting"&&"bg-blue-500/20 text-blue-400",p==="disconnected"&&"bg-yellow-500/20 text-yellow-400",p==="error"&&"bg-red-500/20 text-red-400"),children:[p==="connecting"&&t.jsx(ye,{className:"h-2.5 w-2.5 animate-spin"}),p==="connected"&&"●",p==="disconnected"&&"○",p==="error"&&t.jsx(Ft,{className:"h-2.5 w-2.5"}),p]})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[(p==="disconnected"||p==="error")&&t.jsxs("button",{onClick:U,className:"flex items-center gap-1 px-2 py-0.5 text-[10px] text-[#d4d4d4] hover:text-white hover:bg-[#3c3c3c] rounded transition-colors",children:[t.jsx(Le,{className:"h-2.5 w-2.5"}),"Reconnect"]}),a&&t.jsx("button",{onClick:a,className:"flex items-center justify-center p-1 text-[#d4d4d4] hover:text-white hover:bg-[#3c3c3c] rounded transition-colors",title:r?"Restore":"Maximize",children:r?t.jsx(ms,{className:"h-3.5 w-3.5"}):t.jsx(us,{className:"h-3.5 w-3.5"})})]})]}),t.jsx("div",{ref:f,className:"flex-1 overflow-hidden",style:{padding:"8px"}}),s&&s.length>0&&!g&&p==="connected"&&t.jsx("div",{className:"absolute bottom-2 left-2 right-2 z-10",children:t.jsxs("div",{className:"bg-[#252526]/95 border border-[#3c3c3c] rounded-lg p-3 backdrop-blur-sm",children:[t.jsxs("div",{className:"flex items-center gap-1.5 mb-2",children:[t.jsx(nt,{className:"h-3 w-3 text-[#d4d4d4]"}),t.jsx("span",{className:"text-[10px] text-[#808080] uppercase tracking-wide",children:"Suggested prompts"})]}),t.jsx("div",{className:"flex flex-col gap-1.5",children:s.map((M,D)=>t.jsx("button",{onClick:()=>K(M),className:"text-left text-xs text-[#d4d4d4] hover:text-white bg-[#1e1e1e] hover:bg-[#2d2d2d] rounded px-2.5 py-1.5 transition-colors border border-[#3c3c3c] hover:border-[#505050]",children:M},D))})]})}),p==="error"&&x&&t.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50 z-10",children:t.jsxs("div",{className:"bg-[#252526] border border-[#3c3c3c] rounded-lg p-4 max-w-md text-center",children:[t.jsx(Ft,{className:"h-8 w-8 text-red-400 mx-auto mb-2"}),t.jsx("h3",{className:"text-sm font-medium text-[#d4d4d4] mb-1",children:"Connection Error"}),t.jsx("p",{className:"text-xs text-[#808080] mb-3",children:x}),t.jsx("button",{onClick:U,className:"px-3 py-1.5 bg-[#0e639c] hover:bg-[#1177bb] text-white text-xs rounded transition-colors",children:"Try Again"})]})})]})}function jn({lines:e,className:r=""}){return e.length===0?t.jsx("div",{className:L("h-full flex items-center justify-center text-[var(--color-text-muted)] text-sm",r),children:"No output yet"}):t.jsx("div",{className:L("h-full overflow-y-auto bg-[var(--color-background)] p-2 font-mono text-xs",r),children:e.map(a=>t.jsxs("div",{className:L("py-0.5",a.level==="error"&&"text-red-400",a.level==="warning"&&"text-yellow-400",a.level==="info"&&"text-[var(--color-text-primary)]"),children:[t.jsxs("span",{className:"text-[var(--color-text-muted)]",children:["[",a.timestamp.toLocaleTimeString(),"]"]}),a.source&&t.jsxs("span",{className:"text-[var(--color-accent-primary)] ml-1",children:["[",a.source,"]"]}),t.jsx("span",{className:"ml-1",children:a.message})]},a.id))})}async function kn(e){switch(e){case"python":{const{python:r}=await ve(async()=>{const{python:a}=await import("./vendor-codemirror-langs-BImiyzWt.js").then(s=>s.i);return{python:a}},__vite__mapDeps([0,1]));return r()}case"javascript":case"typescript":{const{javascript:r}=await ve(async()=>{const{javascript:a}=await import("./vendor-codemirror-langs-BImiyzWt.js").then(s=>s.a);return{javascript:a}},__vite__mapDeps([0,1]));return r({jsx:!0,typescript:e==="typescript"})}case"sql":{const{sql:r}=await ve(async()=>{const{sql:a}=await import("./vendor-codemirror-langs-BImiyzWt.js").then(s=>s.b);return{sql:a}},__vite__mapDeps([0,1]));return r()}case"json":{const{json:r}=await ve(async()=>{const{json:a}=await import("./vendor-codemirror-langs-BImiyzWt.js").then(s=>s.c);return{json:a}},__vite__mapDeps([0,1]));return r()}case"yaml":{const{yaml:r}=await ve(async()=>{const{yaml:a}=await import("./vendor-codemirror-langs-BImiyzWt.js").then(s=>s.d);return{yaml:a}},__vite__mapDeps([0,1]));return r()}case"markdown":{const{markdown:r}=await ve(async()=>{const{markdown:a}=await import("./vendor-codemirror-langs-BImiyzWt.js").then(s=>s.g);return{markdown:a}},__vite__mapDeps([0,1]));return r()}case"html":{const{html:r}=await ve(async()=>{const{html:a}=await import("./vendor-codemirror-langs-BImiyzWt.js").then(s=>s.f);return{html:a}},__vite__mapDeps([0,1]));return r()}case"css":{const{css:r}=await ve(async()=>{const{css:a}=await import("./vendor-codemirror-langs-BImiyzWt.js").then(s=>s.e);return{css:a}},__vite__mapDeps([0,1]));return r()}default:return[]}}const Sn=o.memo(function({value:r,onChange:a,filePath:s,language:n,readOnly:i=!1,className:f=""}){const l=o.useRef(null),c=o.useRef(null),u=o.useRef(!1),d=n||(s?la(Ie(s)):"text");return o.useEffect(()=>{if(!l.current)return;let v=!0;return(async()=>{const h=[xa(),pa(),va(),ga(),ya(),ba(),wa(),ja(),ka(),Sa(),Na(Da,{fallback:!0}),Ca,Ea.of([...za,...Pa,...Ra,...Ma,...La,Ta]),rt.updateListener.of(g=>{g.docChanged&&!u.current&&a&&a(g.state.doc.toString())}),_t.readOnly.of(i),rt.theme({"&":{height:"100%",fontSize:"13px"},".cm-scroller":{fontFamily:"JetBrains Mono, Menlo, Monaco, Consolas, monospace",overflow:"auto"},".cm-gutters":{backgroundColor:"var(--color-bg-secondary)",borderRight:"1px solid var(--color-border)"}})],p=await kn(d),m=[...h,p];if(!v)return;const x=_t.create({doc:r,extensions:m}),y=new rt({state:x,parent:l.current});c.current=y})(),()=>{v=!1,c.current&&(c.current.destroy(),c.current=null)}},[]),o.useEffect(()=>{const v=c.current;if(!v)return;const h=v.state.doc.toString();h!==r&&(u.current=!0,v.dispatch({changes:{from:0,to:h.length,insert:r}}),u.current=!1)},[r]),t.jsx("div",{ref:l,className:`h-full w-full overflow-hidden ${f}`})},(e,r)=>e.value===r.value&&e.filePath===r.filePath&&e.readOnly===r.readOnly);function Nn(e,r,a){if(r)return a?t.jsx(lr,{className:"h-4 w-4 text-yellow-500"}):t.jsx(sr,{className:"h-4 w-4 text-yellow-500"});switch(Ie(e)){case"py":return t.jsx(Re,{className:"h-4 w-4 text-blue-400"});case"js":case"jsx":case"ts":case"tsx":return t.jsx(Re,{className:"h-4 w-4 text-yellow-400"});case"json":return t.jsx(or,{className:"h-4 w-4 text-orange-400"});case"yaml":case"yml":return t.jsx(je,{className:"h-4 w-4 text-purple-400"});case"sql":return t.jsx(Re,{className:"h-4 w-4 text-green-400"});case"md":return t.jsx(je,{className:"h-4 w-4 text-gray-400"});default:return t.jsx(Oe,{className:"h-4 w-4 text-gray-400"})}}const Cn=o.memo(function e({node:r,depth:a,selectedPath:s,expandedPaths:n,onToggleExpand:i,onFileSelect:f,onFileDelete:l}){const c=r.type==="directory",u=n.has(r.path),d=s===r.path,[v,h]=o.useState(!1),p=o.useCallback(()=>{c?i(r.path):f(r.path)},[c,r.path,i,f]),m=o.useCallback(x=>{x.stopPropagation(),l&&confirm(`Delete ${r.name}?`)&&l(r.path)},[r.name,r.path,l]);return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:L("flex items-center gap-1 px-2 py-1 cursor-pointer hover:bg-[var(--color-bg-secondary)] transition-colors",d&&"bg-[var(--color-accent-primary)]/20 hover:bg-[var(--color-accent-primary)]/30"),style:{paddingLeft:`${a*12+8}px`},onClick:p,onMouseEnter:()=>h(!0),onMouseLeave:()=>h(!1),children:[c?t.jsx("span",{className:"w-4 h-4 flex items-center justify-center text-[var(--color-text-muted)]",children:u?t.jsx(Ge,{className:"h-3 w-3"}):t.jsx(Je,{className:"h-3 w-3"})}):t.jsx("span",{className:"w-4 h-4"}),Nn(r.name,c,u),t.jsx("span",{className:"flex-1 text-xs text-[var(--color-text-primary)] truncate",children:r.name}),v&&l&&!c&&t.jsx("button",{onClick:m,className:"p-0.5 rounded hover:bg-red-500/20 text-[var(--color-text-muted)] hover:text-red-400 transition-colors",title:"Delete file",children:t.jsx(ia,{className:"h-3 w-3"})})]}),c&&u&&r.children&&t.jsx(t.Fragment,{children:r.children.map(x=>t.jsx(e,{node:x,depth:a+1,selectedPath:s,expandedPaths:n,onToggleExpand:i,onFileSelect:f,onFileDelete:l},x.path))})]})});function En({files:e,selectedPath:r,onFileSelect:a,onFileCreate:s,onFileDelete:n,onRefresh:i,isLoading:f=!1,className:l=""}){const[c,u]=o.useState(new Set),d=o.useCallback(v=>{u(h=>{const p=new Set(h);return p.has(v)?p.delete(v):p.add(v),p})},[]);return t.jsxs("div",{className:L("flex flex-col h-full",l),children:[t.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b border-[var(--color-border)]",children:[t.jsx("span",{className:"text-xs font-medium text-[var(--color-text-muted)] uppercase tracking-wider",children:"Files"}),t.jsxs("div",{className:"flex items-center gap-1",children:[s&&t.jsx("button",{onClick:()=>{const v=prompt("Enter file name:");v&&s(v)},className:"p-1 rounded hover:bg-[var(--color-bg-secondary)] text-[var(--color-text-muted)] hover:text-[var(--color-text-primary)] transition-colors",title:"New file",children:t.jsx(ot,{className:"h-4 w-4"})}),i&&t.jsx("button",{onClick:i,disabled:f,className:"p-1 rounded hover:bg-[var(--color-bg-secondary)] text-[var(--color-text-muted)] hover:text-[var(--color-text-primary)] transition-colors disabled:opacity-50",title:"Refresh",children:t.jsx(Le,{className:L("h-4 w-4",f&&"animate-spin")})})]})]}),t.jsx("div",{className:"flex-1 overflow-y-auto py-1",children:e.length===0?t.jsx("div",{className:"px-3 py-4 text-xs text-[var(--color-text-muted)] text-center",children:f?"Loading files...":"No files yet"}):e.map(v=>t.jsx(Cn,{node:v,depth:0,selectedPath:r,expandedPaths:c,onToggleExpand:d,onFileSelect:a,onFileDelete:n},v.path))})]})}function zn(e){switch(Ie(e)){case"py":return t.jsx(Re,{className:"h-3.5 w-3.5 text-blue-400"});case"js":case"jsx":case"ts":case"tsx":return t.jsx(Re,{className:"h-3.5 w-3.5 text-yellow-400"});case"json":return t.jsx(or,{className:"h-3.5 w-3.5 text-orange-400"});case"yaml":case"yml":return t.jsx(je,{className:"h-3.5 w-3.5 text-purple-400"});case"sql":return t.jsx(Re,{className:"h-3.5 w-3.5 text-green-400"});case"md":return t.jsx(je,{className:"h-3.5 w-3.5 text-gray-400"});default:return t.jsx(Oe,{className:"h-3.5 w-3.5 text-gray-400"})}}const Pn=o.memo(function({tabs:r,activeTab:a,onTabSelect:s,onTabClose:n,className:i=""}){const f=o.useCallback((l,c)=>{l.stopPropagation(),n(c)},[n]);return r.length===0?null:t.jsx("div",{className:L("flex items-center border-b border-[var(--color-border)] bg-[var(--color-bg-secondary)]/50 overflow-x-auto",i),children:r.map(l=>{const c=a===l.path;return t.jsxs("button",{onClick:()=>s(l.path),className:L("flex items-center gap-1.5 px-3 py-2 text-xs border-r border-[var(--color-border)] min-w-0 max-w-[150px] group transition-colors",c?"bg-[var(--color-background)] text-[var(--color-text-primary)]":"text-[var(--color-text-muted)] hover:bg-[var(--color-background)]/50 hover:text-[var(--color-text-primary)]"),children:[zn(l.name),t.jsxs("span",{className:"truncate",children:[l.name,l.isDirty&&t.jsx("span",{className:"text-[var(--color-accent-primary)]",children:"*"})]}),t.jsx("span",{onClick:u=>f(u,l.path),className:L("ml-auto p-0.5 rounded hover:bg-[var(--color-bg-secondary)] transition-colors",c?"opacity-100":"opacity-0 group-hover:opacity-100"),title:"Close",children:t.jsx(Ae,{className:"h-3 w-3"})})]},l.path)})})});function Rn({projectId:e,className:r=""}){const[a,s]=o.useState(""),[n,i]=o.useState(""),[f,l]=o.useState(0),[c,u]=o.useState("deployed"),[d,v]=o.useState(!1),[h,p]=o.useState(null);o.useEffect(()=>{(async()=>{try{const b=await Ue(e);b.app_url&&c==="deployed"&&(s(b.app_url),i(b.app_url))}catch{}})()},[e,c]),o.useEffect(()=>{const j=async()=>{try{const R=await(await fetch(`/api/projects/${e}/preview/status`)).json();if(R.status==="running"){if(v(!0),p(R.port),c==="local"){const z=`/api/projects/${e}/preview/`;s(z),i(z)}}else v(!1),p(null)}catch{v(!1),p(null)}};j();const b=setInterval(j,15e3),w=()=>{if(document.hidden)clearInterval(b);else{j();const P=setInterval(j,15e3);return()=>clearInterval(P)}};return document.addEventListener("visibilitychange",w),()=>{clearInterval(b),document.removeEventListener("visibilitychange",w)}},[e,c]);const m=o.useCallback(j=>{j.preventDefault(),n.trim()&&s(n.trim())},[n]),x=o.useCallback(()=>{l(j=>j+1)},[]),y=o.useCallback(()=>{a&&window.open(a,"_blank","noopener,noreferrer")},[a]),g=o.useCallback(async()=>{try{const b=await(await fetch(`/api/projects/${e}/preview/start`,{method:"POST"})).json();if(b.status==="started"||b.status==="already_running"){v(!0),p(b.port),u("local");const w=`/api/projects/${e}/preview/`;s(w),i(w),l(P=>P+1),ne.success(`Preview server started on port ${b.port}`)}}catch(j){console.error("Failed to start preview server:",j),ne.error("Failed to start preview server")}},[e]),N=o.useCallback(async()=>{try{await fetch(`/api/projects/${e}/preview/stop`,{method:"POST"}),v(!1),p(null),s(""),i(""),ne.success("Preview server stopped")}catch(j){console.error("Failed to stop preview server:",j),ne.error("Failed to stop preview server")}},[e]);return t.jsxs("div",{className:L("flex flex-col h-full",r),children:[t.jsxs("div",{className:"flex items-center gap-2 h-8 px-2 bg-[var(--color-bg-secondary)]/50 border-b border-[var(--color-border)] flex-shrink-0",children:[t.jsxs("div",{className:"flex items-center gap-1 border border-[var(--color-border)] rounded overflow-hidden",children:[t.jsx("button",{onClick:()=>u("local"),className:L("px-2 py-0.5 text-xs transition-colors",c==="local"?"bg-[var(--color-accent-primary)] text-white":"text-[var(--color-text-muted)] hover:bg-[var(--color-bg-secondary)]"),children:"Local"}),t.jsx("button",{onClick:()=>u("deployed"),className:L("px-2 py-0.5 text-xs transition-colors",c==="deployed"?"bg-[var(--color-accent-primary)] text-white":"text-[var(--color-text-muted)] hover:bg-[var(--color-bg-secondary)]"),children:"Deployed"})]}),c==="local"&&t.jsx(t.Fragment,{children:d?t.jsxs(t.Fragment,{children:[t.jsxs("button",{onClick:N,className:"flex items-center gap-1 px-2 py-0.5 text-xs bg-red-500/20 text-red-400 rounded hover:bg-red-500/30 transition-colors",children:[t.jsx(Ss,{className:"h-3 w-3"}),"Stop"]}),t.jsxs("span",{className:"text-xs text-[var(--color-text-muted)]",children:["Port ",h]})]}):t.jsxs("button",{onClick:g,className:"flex items-center gap-1 px-2 py-0.5 text-xs bg-green-500/20 text-green-400 rounded hover:bg-green-500/30 transition-colors",children:[t.jsx(dr,{className:"h-3 w-3"}),"Start Server"]})}),t.jsx("button",{onClick:x,className:"p-1 rounded hover:bg-[var(--color-bg-secondary)] text-[var(--color-text-muted)] hover:text-[var(--color-text-primary)] transition-colors ml-auto",title:"Refresh",children:t.jsx(Le,{className:"h-3 w-3"})}),t.jsx("button",{onClick:y,disabled:!a,className:"p-1 rounded hover:bg-[var(--color-bg-secondary)] text-[var(--color-text-muted)] hover:text-[var(--color-text-primary)] transition-colors disabled:opacity-30",title:"Open in new tab",children:t.jsx(nr,{className:"h-3 w-3"})})]}),a&&t.jsxs("div",{className:"flex items-center gap-1.5 h-6 px-2 bg-[var(--color-background)]/50 border-b border-[var(--color-border)] flex-shrink-0",children:[t.jsx(At,{className:"h-3 w-3 text-[var(--color-text-muted)]"}),t.jsx("form",{onSubmit:m,className:"flex-1 flex",children:t.jsx("input",{type:"text",value:n,onChange:j=>i(j.target.value),placeholder:"Enter URL...",className:"flex-1 h-4 px-2 text-xs bg-transparent border-none text-[var(--color-text-primary)] placeholder:text-[var(--color-text-muted)] focus:outline-none"})})]}),a?t.jsx("iframe",{src:a,className:"flex-1 w-full border-none bg-white",sandbox:"allow-scripts allow-same-origin allow-forms allow-popups",title:"App preview"},f):t.jsx("div",{className:"flex-1 flex items-center justify-center bg-[var(--color-background)]",children:t.jsxs("div",{className:"text-center",children:[t.jsx(At,{className:"h-8 w-8 mx-auto text-[var(--color-text-muted)] opacity-50"}),t.jsx("p",{className:"mt-2 text-xs text-[var(--color-text-muted)]",children:"No app running. Deploy your app first or enter a URL above."})]})})]})}function Mn({projectId:e,className:r=""}){const[a,s]=o.useState({status:"idle"}),[n,i]=o.useState([]),[f,l]=o.useState(!1);o.useEffect(()=>{(async()=>{try{const p=await Ue(e);s(p)}catch(p){console.error("Failed to fetch deploy status:",p)}})()},[e]),o.useEffect(()=>{if(a.status!=="deploying")return;const h=new AbortController;return(async()=>{try{await Yr(e,x=>{i(y=>[...y,x])},h.signal);const m=await Ue(e);s(m)}catch(m){m instanceof Error&&m.name!=="AbortError"&&console.error("Failed to stream deploy logs:",m)}})(),()=>{h.abort()}},[e,a.status]);const c=o.useCallback(async()=>{try{i([]),l(!0),await Xr(e),s({status:"deploying"})}catch(h){console.error("Failed to deploy:",h),s({status:"error",error:h instanceof Error?h.message:"Unknown error"})}},[e]),u=o.useCallback(async()=>{try{const h=await Ue(e);s(h)}catch(h){console.error("Failed to fetch deploy status:",h)}},[e]),d=()=>{switch(a.status){case"deploying":return"text-yellow-500";case"success":return"text-green-500";case"error":return"text-red-500";default:return"text-[var(--color-text-muted)]"}},v=()=>{switch(a.status){case"deploying":return t.jsx(ye,{className:"h-4 w-4 animate-spin"});case"success":return t.jsx("span",{className:"w-2 h-2 rounded-full bg-green-500"});case"error":return t.jsx(Wa,{className:"h-4 w-4"});default:return t.jsx("span",{className:"w-2 h-2 rounded-full bg-gray-500"})}};return t.jsxs("div",{className:L("border-t border-[var(--color-border)]",r),children:[t.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-[var(--color-bg-secondary)]/50",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(ca,{onClick:c,disabled:a.status==="deploying",className:"h-7 px-2 text-xs",children:a.status==="deploying"?t.jsxs(t.Fragment,{children:[t.jsx(ye,{className:"h-3 w-3 mr-1 animate-spin"}),"Deploying..."]}):t.jsxs(t.Fragment,{children:[t.jsx(dr,{className:"h-3 w-3 mr-1"}),"Deploy"]})}),t.jsxs("div",{className:L("flex items-center gap-1.5 text-xs",d()),children:[v(),t.jsx("span",{className:"capitalize",children:a.status})]}),a.app_url&&t.jsxs("a",{href:a.app_url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-xs text-[var(--color-accent-primary)] hover:underline",children:[t.jsx(nr,{className:"h-3 w-3"}),"Open App"]})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("button",{onClick:u,className:"p-1 rounded hover:bg-[var(--color-bg-secondary)] text-[var(--color-text-muted)] hover:text-[var(--color-text-primary)] transition-colors",title:"Refresh status",children:t.jsx(Le,{className:"h-3.5 w-3.5"})}),t.jsx("button",{onClick:()=>l(!f),className:"px-2 py-0.5 text-xs text-[var(--color-text-muted)] hover:text-[var(--color-text-primary)] transition-colors",children:f?"Hide Logs":"Show Logs"})]})]}),f&&t.jsx("div",{className:"h-32 overflow-y-auto bg-[var(--color-background)] p-2 font-mono text-xs",children:n.length===0?t.jsx("div",{className:"text-[var(--color-text-muted)]",children:a.status==="deploying"?"Waiting for logs...":"No deployment logs"}):n.map((h,p)=>t.jsxs("div",{className:L("py-0.5",h.level==="error"&&"text-red-400",h.level==="warning"&&"text-yellow-400",h.level==="info"&&"text-[var(--color-text-primary)]"),children:[t.jsxs("span",{className:"text-[var(--color-text-muted)]",children:["[",new Date(h.timestamp).toLocaleTimeString(),"]"]})," ",h.message]},p))}),a.error&&t.jsxs("div",{className:"px-3 py-2 bg-red-500/10 text-red-400 text-xs",children:["Error: ",a.error]})]})}const Ln=o.memo(function({paneId:r,tabs:a,activeTabPath:s,onTabSelect:n,onTabClose:i,onContentChange:f,isFocused:l=!1,onFocus:c,className:u=""}){const d=a.find(x=>x.path===s),v=o.useCallback(x=>{n(r,x)},[r,n]),h=o.useCallback(x=>{i(r,x)},[r,i]),p=o.useCallback(x=>{s&&f(r,s,x)},[r,s,f]),m=o.useCallback(()=>{c==null||c(r)},[r,c]);return t.jsxs("div",{className:`flex flex-col h-full min-w-0 ${u}`,onClick:m,children:[t.jsx(Pn,{tabs:a.map(x=>({path:x.path,name:x.name,isDirty:x.isDirty})),activeTab:s,onTabSelect:v,onTabClose:h,className:l?"border-b-2 border-b-[var(--color-accent-primary)]":""}),t.jsx("div",{className:"flex-1 overflow-hidden",children:d?t.jsx(Sn,{value:d.content,onChange:p,filePath:d.path}):t.jsx("div",{className:"h-full flex items-center justify-center text-[var(--color-text-muted)] text-sm",children:a.length===0?"No files open":"Select a file to edit"})})]})},(e,r)=>e.paneId===r.paneId&&e.activeTabPath===r.activeTabPath&&e.tabs===r.tabs&&e.isFocused===r.isFocused);function Tn({direction:e,first:r,second:a,splitRatio:s,onSplitRatioChange:n,renderPane:i}){const f=o.useRef(null),l=o.useRef(null);o.useEffect(()=>{const u=l.current,d=f.current;if(!u||!d)return;let v=!1;const h=()=>{v=!0,document.body.style.cursor=e==="horizontal"?"col-resize":"row-resize",document.body.style.userSelect="none"},p=x=>{if(!v)return;const y=d.getBoundingClientRect();let g;e==="horizontal"?g=(x.clientX-y.left)/y.width*100:g=(x.clientY-y.top)/y.height*100,n(Math.min(Math.max(g,20),80))},m=()=>{v=!1,document.body.style.cursor="",document.body.style.userSelect=""};return u.addEventListener("mousedown",h),document.addEventListener("mousemove",p),document.addEventListener("mouseup",m),()=>{u.removeEventListener("mousedown",h),document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",m)}},[e,n]);const c=e==="horizontal";return t.jsxs("div",{ref:f,className:L("flex h-full",c?"flex-row":"flex-col"),children:[t.jsx("div",{style:{[c?"width":"height"]:`${s}%`},className:"overflow-hidden",children:i(r)}),t.jsx("div",{ref:l,className:L("flex items-center justify-center bg-[var(--color-border)] hover:bg-[var(--color-accent-primary)]/50 transition-colors",c?"w-1 cursor-col-resize":"h-1 cursor-row-resize"),children:c?t.jsx(cr,{className:"h-4 w-4 text-[var(--color-text-muted)]"}):t.jsx(ir,{className:"h-4 w-4 text-[var(--color-text-muted)]"})}),t.jsx("div",{style:{[c?"width":"height"]:`${100-s}%`},className:"overflow-hidden",children:i(a)})]})}function Dn({layout:e,panes:r,focusedPaneId:a,onLayoutChange:s,onFocusPane:n,onTabSelect:i,onTabClose:f,onContentChange:l,className:c=""}){const u=o.useCallback((v,h)=>{const p=(m,x)=>{if(x.length===0)return{...m,splitRatio:h};const[y,...g]=x;if(m.type==="split"){if(y==="first"&&m.first)return{...m,first:p(m.first,g)};if(y==="second"&&m.second)return{...m,second:p(m.second,g)}}return m};s(p(e,v))},[e,s]),d=o.useCallback((v,h=[])=>{if(v.type==="leaf"&&v.paneId){const p=r[v.paneId]||{tabs:[]};return t.jsx(Ln,{paneId:v.paneId,tabs:p.tabs,activeTabPath:p.activeTabPath,onTabSelect:i,onTabClose:f,onContentChange:l,isFocused:a===v.paneId,onFocus:n})}return v.type==="split"&&v.first&&v.second&&v.direction?t.jsx(Tn,{direction:v.direction,first:v.first,second:v.second,splitRatio:v.splitRatio||50,onSplitRatioChange:p=>u(h,p),renderPane:p=>d(p,[...h,p===v.first?"first":"second"])}):null},[r,a,i,f,l,n,u]);return t.jsx("div",{className:L("h-full overflow-hidden",c),children:d(e)})}function _n(e="main"){return{type:"leaf",paneId:e}}function dt(e,r,a,s){return e.type==="leaf"&&e.paneId===r?{type:"split",direction:a,first:{type:"leaf",paneId:r},second:{type:"leaf",paneId:s},splitRatio:50}:e.type==="split"&&e.first&&e.second?{...e,first:dt(e.first,r,a,s),second:dt(e.second,r,a,s)}:e}function $n(e){const r=o.useCallback(a=>{const s=a.target,n=s.tagName==="INPUT"||s.tagName==="TEXTAREA"||s.isContentEditable;for(const i of e){if(n&&i.disableInInput!==!1&&!(i.key.toLowerCase()==="s"||i.key.toLowerCase()==="p"))continue;const f=a.key.toLowerCase()===i.key.toLowerCase(),l=!!i.ctrl===a.ctrlKey,c=!!i.meta===a.metaKey,u=!!i.shift===a.shiftKey,d=!!i.alt===a.altKey,h=navigator.platform.toUpperCase().indexOf("MAC")>=0?(i.meta||i.ctrl)===a.metaKey:(i.ctrl||i.meta)===a.ctrlKey;if(f&&u&&d){if(i.meta||i.ctrl){if(h){a.preventDefault(),i.action();return}}else if(l&&c){a.preventDefault(),i.action();return}}}},[e]);o.useEffect(()=>(window.addEventListener("keydown",r),()=>window.removeEventListener("keydown",r)),[r])}function rr(e,r){return{key:e,meta:!0,ctrl:!0,action:r}}function qe(e,r){return{key:e,meta:!0,ctrl:!0,shift:!0,action:r}}function ut(e){return e.replace(/[^a-zA-Z0-9]/g,"_").toLowerCase()}function Fn(e,r){if(!e)return"";const a=e.split("@")[0],s=ut(a);if(!r)return s;const n=ut(r);return`${s}_${n}`}function qn(){const{projectId:e}=Wr(),r=qr(),{user:a,branding:s}=Qr(),[n,i]=o.useState(null),[f,l]=o.useState(!0),[,c]=o.useState([]),[u,d]=o.useState(),[,v]=o.useState([]),[h,p]=o.useState(),[m]=o.useState("ai_dev_kit"),[x,y]=o.useState(""),[g,N]=o.useState(""),[j,b]=o.useState(!1),[w,P]=o.useState([]),[R,z]=o.useState(!1),[I,T]=o.useState(new Map),[C,E]=o.useState("explorer"),[G,K]=o.useState(()=>{const S=localStorage.getItem("panel-leftSidebarWidth");return S?parseInt(S,10):200}),[U,M]=o.useState(()=>{const S=localStorage.getItem("panel-rightSidebarWidth");return S?parseInt(S,10):450}),[D,B]=o.useState(!0),[$,H]=o.useState(()=>{const S=localStorage.getItem("panel-bottomPanelHeight");return S?parseInt(S,10):300}),[J,X]=o.useState(!1),[Y,le]=o.useState("terminal"),[ie]=o.useState([]),[Te,k]=o.useState(!1),[F,ae]=o.useState(_n("main")),[ue,ce]=o.useState({main:{tabs:[],activeTabPath:void 0}}),[se,Xe]=o.useState("main"),[Cr,bt]=o.useState(!1),[Er,Ye]=o.useState(!1);o.useEffect(()=>{localStorage.setItem("panel-leftSidebarWidth",String(G))},[G]),o.useEffect(()=>{localStorage.setItem("panel-rightSidebarWidth",String(U))},[U]),o.useEffect(()=>{localStorage.setItem("panel-bottomPanelHeight",String($))},[$]);const Qe=o.useMemo(()=>Fn(a,(n==null?void 0:n.name)??null),[a,n==null?void 0:n.name]),zr=ue[se]||{activeTabPath:void 0},Pr=o.useMemo(()=>[{id:"file.save",label:"Save File",shortcut:"Cmd+S",category:xe.FILE,action:()=>wt()},{id:"file.quickOpen",label:"Go to File",shortcut:"Cmd+P",category:xe.FILE,action:()=>Ye(!0)},{id:"view.toggleClaude",label:"Toggle Claude Terminal",shortcut:"Cmd+Shift+C",category:xe.VIEW,action:()=>B(S=>!S)},{id:"view.toggleTerminal",label:"Toggle Terminal",shortcut:"Cmd+`",category:xe.TERMINAL,action:()=>{X(S=>!S),J||le("terminal")}},{id:"view.toggleExplorer",label:"Toggle Explorer",shortcut:"Cmd+Shift+E",category:xe.VIEW,action:()=>E(S=>S==="explorer"?null:"explorer")},{id:"search.global",label:"Search in Files",shortcut:"Cmd+Shift+F",category:xe.SEARCH,action:()=>E("search")},{id:"editor.splitRight",label:"Split Editor Right",category:xe.VIEW,action:()=>kt("horizontal")},{id:"editor.splitDown",label:"Split Editor Down",category:xe.VIEW,action:()=>kt("vertical")},{id:"view.skills",label:"View System Prompt & Skills",category:xe.VIEW,action:()=>b(!0)}],[J]);$n([rr("s",()=>wt()),rr("p",()=>Ye(!0)),qe("p",()=>bt(!0)),qe("f",()=>E("search")),qe("e",()=>E(S=>S==="explorer"?null:"explorer")),qe("c",()=>B(S=>!S)),{key:"`",meta:!0,action:()=>{X(S=>!S),J||le("terminal")}}]),o.useEffect(()=>{if(!e)return;(async()=>{try{l(!0);const[A,_,O,Q]=await Promise.all([aa(e),sa().catch(()=>[]),na().catch(()=>[]),Be(e).catch(()=>[])]);i(A),c(_),v(O),P(Q),_.length>0&&d(_[0].cluster_id),O.length>0&&p(O[0].warehouse_id)}catch(A){console.error("Failed to load project:",A),ne.error("Failed to load project"),r("/")}finally{l(!1)}})()},[e,r]),o.useEffect(()=>{Qe&&!x&&y(Qe)},[Qe,x]),o.useEffect(()=>{if(a&&(n!=null&&n.name)&&!g){const S=ut(n.name);N(`/Workspace/Users/${a}/ai_dev_kit/${S}`)}},[a,n==null?void 0:n.name,g]),o.useEffect(()=>{document.title=n!=null&&n.name?`${n.name} - ${s.app_title}`:s.app_title},[n==null?void 0:n.name,s.app_title]);const Ce=o.useCallback(async(S,A)=>{const _=A||se,O=ue[_]||{tabs:[],activeTabPath:void 0};if(O.tabs.find(q=>q.path===S)){ce(q=>({...q,[_]:{...O,activeTabPath:S}}));return}if(e)try{let q;const Z=I.get(S),fe=Z?Date.now()-Z.timestamp:1/0;Z&&fe<6e4?q=Z.content:(q=(await Zr(e,S)).content,T(Gr=>{const De=new Map(Gr);if(De.size>=50){let tt=null,Ct=1/0;for(const[Br,Et]of De)Et.timestamp<Ct&&(Ct=Et.timestamp,tt=Br);tt&&De.delete(tt)}return De.set(S,{content:q,timestamp:Date.now()}),De}));const et=S.split("/").pop()||S,Ir={path:S,name:et,content:q,originalContent:q,isDirty:!1};ce(Nt=>({...Nt,[_]:{tabs:[...O.tabs,Ir],activeTabPath:S}}))}catch(q){console.error("Failed to load file:",q),ne.error("Failed to load file")}},[e,se,ue,I]),Rr=o.useCallback((S,A,_)=>{ce(O=>{const Q=O[S];return Q?{...O,[S]:{...Q,tabs:Q.tabs.map(q=>q.path===A?{...q,content:_,isDirty:_!==q.originalContent}:q)}}:O})},[]),wt=o.useCallback(async()=>{const S=ue[se];if(!(S!=null&&S.activeTabPath)||!e)return;const A=S.tabs.find(_=>_.path===S.activeTabPath);if(A)try{await ea(e,A.path,A.content),T(_=>{const O=new Map(_);return O.delete(A.path),O}),ce(_=>({..._,[se]:{...S,tabs:S.tabs.map(O=>O.path===A.path?{...O,originalContent:O.content,isDirty:!1}:O)}})),ne.success("File saved")}catch(_){console.error("Failed to save file:",_),ne.error("Failed to save file")}},[e,se,ue]),Mr=o.useCallback((S,A)=>{ce(_=>{const O=_[S];return O?{..._,[S]:{...O,activeTabPath:A}}:_}),Xe(S)},[]),Lr=o.useCallback((S,A)=>{ce(_=>{const O=_[S];if(!O)return _;const Q=O.tabs.filter(Z=>Z.path!==A);let q=O.activeTabPath;return O.activeTabPath===A&&(q=Q.length>0?Q[Q.length-1].path:void 0),{..._,[S]:{tabs:Q,activeTabPath:q}}})},[]),Tr=o.useCallback(async S=>{if(e)try{await ta(e,S);const A=await Be(e);P(A),Ce(S),ne.success("File created")}catch(A){console.error("Failed to create file:",A),ne.error("Failed to create file")}},[e,Ce]),Dr=o.useCallback(async S=>{if(e)try{await ra(e,S);const A=await Be(e);P(A),ce(_=>{const O={..._};for(const Q of Object.keys(O)){const q=O[Q];if(q.tabs.some(Z=>Z.path===S)){const Z=q.tabs.filter(et=>et.path!==S);let fe=q.activeTabPath;q.activeTabPath===S&&(fe=Z.length>0?Z[Z.length-1].path:void 0),O[Q]={tabs:Z,activeTabPath:fe}}}return O}),ne.success("File deleted")}catch(A){console.error("Failed to delete file:",A),ne.error("Failed to delete file")}},[e]),jt=o.useCallback(async()=>{if(e){z(!0);try{const S=await Be(e);P(S)}catch(S){console.error("Failed to refresh files:",S),ne.error("Failed to refresh files")}finally{z(!1)}}},[e]),kt=o.useCallback(S=>{const A=`pane-${Date.now()}`;ae(_=>dt(_,se,S,A)),ce(_=>({..._,[A]:{tabs:[],activeTabPath:void 0}})),Xe(A)},[se]),_r=o.useCallback((S,A)=>{Ce(S)},[Ce]),$r=o.useCallback((S,A)=>{const _=`diff://${S}`,O=ue[se]||{tabs:[],activeTabPath:void 0};if(O.tabs.find(fe=>fe.path===_)){ce(fe=>({...fe,[se]:{...O,activeTabPath:_}}));return}const q=`${S.split("/").pop()||S} (diff)`,Z={path:_,name:q,content:A,originalContent:A,isDirty:!1};ce(fe=>({...fe,[se]:{tabs:[...O.tabs,Z],activeTabPath:_}}))},[se,ue]);if(f)return t.jsx(Dt,{projectName:n==null?void 0:n.name,children:t.jsx("div",{className:"flex h-full items-center justify-center",children:t.jsx(ye,{className:"h-8 w-8 animate-spin text-[var(--color-text-muted)]"})})});const Fr=C==="explorer"?t.jsx(En,{files:w,selectedPath:zr.activeTabPath,onFileSelect:Ce,onFileCreate:Tr,onFileDelete:Dr,onRefresh:jt,isLoading:R}):C==="search"&&e?t.jsx(xn,{projectId:e,onResultSelect:_r}):C==="git"&&e?t.jsx(pn,{projectId:e,onOpenDiff:$r}):null,Ze=n!=null&&n.template?da(n.template):void 0,Ar=Ze==null?void 0:Ze.suggestedPrompts,Or=Y==="terminal"&&e?t.jsx(vn,{projectId:e}):Y==="output"?t.jsx(jn,{lines:ie}):Y==="deploy"&&e?t.jsx("div",{className:"h-full overflow-hidden",children:t.jsx(Mn,{projectId:e})}):Y==="preview"&&e?t.jsx(Rn,{projectId:e}):null,St=e?t.jsx(wn,{projectId:e,isMaximized:Te,onToggleMaximize:()=>k(S=>!S),suggestedPrompts:Ar,onFilesChanged:jt}):null;return t.jsxs(Dt,{projectName:n==null?void 0:n.name,children:[t.jsx(on,{activeActivity:C,onActivityChange:S=>{E(S),S==="chat"&&(B(!0),E(null))},leftSidebar:Fr,leftSidebarWidth:G,onLeftSidebarWidthChange:K,rightSidebar:St,rightSidebarWidth:U,onRightSidebarWidthChange:M,isRightSidebarOpen:D,isClaudeMaximized:Te,maximizedContent:St,bottomPanel:Or,bottomPanelHeight:$,onBottomPanelHeightChange:H,isBottomPanelOpen:J,onBottomPanelToggle:()=>X(S=>!S),bottomPanelTab:Y,onBottomPanelTabChange:le,children:t.jsx(Dn,{layout:F,panes:ue,focusedPaneId:se,onLayoutChange:ae,onPaneStateChange:(S,A)=>ce(_=>({..._,[S]:{..._[S],...A}})),onFocusPane:Xe,onTabSelect:Mr,onTabClose:Lr,onContentChange:Rr})}),t.jsx(dn,{isOpen:Cr,onClose:()=>bt(!1),commands:Pr}),t.jsx(fn,{isOpen:Er,onClose:()=>Ye(!1),files:w,onFileSelect:Ce}),j&&e&&t.jsx(ln,{projectId:e,systemPromptParams:{clusterId:u,warehouseId:h,defaultCatalog:m,defaultSchema:x,workspaceFolder:g},onClose:()=>b(!1)})]})}export{qn as default};
